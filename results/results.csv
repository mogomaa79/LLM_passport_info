outputs.output,error,reference.name,reference.gender,reference.mrzSex,reference.number,reference.country,reference.surname,reference.mrzLine1,reference.mrzLine2,reference.birth date,reference.issue date,reference.mrzSurname,reference.expiry date,reference.father name,reference.middle name,reference.mother name,reference.mrzGivenNames,reference.mrzDateOfBirth,reference.place of birth,reference.place of issue,reference.mrzDateOfExpiry,reference.original gender,reference.original number,reference.country of issue,reference.original country,reference.mrzPassportNumber,reference.original birth date,reference.original expiry date,feedback.full_passport,feedback.field_match,execution_time,example_id,id,outputs.original number,outputs.number,outputs.original country,outputs.country,outputs.name,outputs.surname,outputs.middle name,outputs.original gender,outputs.gender,outputs.place of birth,outputs.original birth date,outputs.birth date,outputs.issue date,outputs.original expiry date,outputs.expiry date,outputs.mother name,outputs.father name,outputs.place of issue,outputs.country of issue,outputs.mrzLine1,outputs.mrzLine2,outputs.mrzPassportNumber,outputs.mrzDateOfBirth,outputs.mrzDateOfExpiry,outputs.mrzSex,outputs.mrzSurname,outputs.mrzGivenNames,inputs.image_id,output
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",KALANDAR SHAFI,M,M,N7198775,IND,KALANDAR SHAFI,P<IND<KALANDAR<SHAFI<<<<<<<<<<<<<<<<<<<<<,N7198775<1IND9610057M2602084<<<<<<<<<<<<<<04,05/10/1996,09/02/2016,KALANDAR,08/02/2026,ABOOBBAKKAR,,MAIMUNA,SHAFI,05/10/1996,PUTHILA KARNATAKA,BANGALORE,08/02/2026,M,N7198775,INDIA,IND,N7198775,05/10/1996,08/02/2026,False,0,2.375488,82a56fdc-c51c-45ed-854f-2e547b74eaa2,8c8fe19a-1c57-45fa-88ab-cf12f60ffb16,,,,,,,,,,,,,,,,,,,,,,,,,,,,83344,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",VEENUS,F,F,S2495337,IND,VEENUS,P<IND<VEENUS<<<<<<<<<<<<<<<<<<<<<<<<<<<<<,S2495337<9IND820315F2806066<<<<<<<<<<<<<<04,15/03/1982,07/06/2018,VEENUS,06/06/2028,DARSHAN MASIH,,,,15/03/1982,"JALANDHAR, PUNJAB",JALANDHAR,06/06/2028,F,S2495337,INDIA,IND,S2495337,15/03/1982,06/06/2028,False,0,2.491824,f87dec12-14ac-46c8-a34b-a00137d3b228,52368a89-36d3-42b9-8019-efffdf0b44c8,,,,,,,,,,,,,,,,,,,,,,,,,,,,85340,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm unable to process images directly. However, you can use OCR software to extract text from the passport image and then follow the detailed instructions provided to convert the extracted data into a JSON format. If you have any questions about the process, feel free to ask!\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm unable to process images directly. However, you can use OCR software to extract text from the passport image and then follow the detailed instructions provided to convert the extracted data into a JSON format. If you have any questions about the process, feel free to ask!
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",AKHILA,F,F,C5730094,IND,AMBILY,P<INDAMBILY<<AKHILA<<<<<<<<<<<<<<<<<<<<<<,C5730094<2IND9705146F3412259106342<<<<<<4,14/05/1997,26/12/2024,AMBILY,25/12/2034,,,BABU,AKHILA,14/05/1997,KOLLAM KERALA,TRIVANDRUM,25/12/2034,F,C5730094,INDIA,IND,C5730094,14/05/1997,25/12/2034,False,0,3.563311,0b1a7be1-1fee-4eeb-9ffd-22fbdbeb2da0,64b84938-ba06-49af-996e-88850b2a4c7b,,,,,,,,,,,,,,,,,,,,,,,,,,,,83343,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",HARSH ULHAS,F,F,V4853612,IND,CHARI,P<INDCHARI<HARSHA<ULHAS,V4853612<0IND9908095F3203019<<<<<<<<<<<<<,09/08/1999,02/03/2022,CHARI,01/03/2032,ULHAS CHARI,,RAJSHREE,HARSHA ULHAS,09/08/1999,MARGAO GOA,PANAJI,01/03/2032,F,V4853612,INDIA,IND,V4853612,09/08/1999,01/03/2032,False,0,6.355491,240611bb-6f21-4983-9692-acc0b53497b6,0da8dc57-457a-4983-b4d5-3ba72304f6a6,,,,,,,,,,,,,,,,,,,,,,,,,,,,85456,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",MERY MUNNISA,F,F,U8128685,IND,SHEIK,P<INDSHEIK<MERY<MUNNISA<<<<<<<<<<<<<<<<<,U8128685<0IND9408207F3103265310310444,20/08/1994,26/03/2021,SHEIK,25/03/2031,PEER BHASHA SHEIK,,SULTHANBIBI,MERY MUNNISA,20/08/1994,NARASAPURAM ANDHRA PRADESH,VISAKHAPATNAM,25/03/2031,F,U8128685,INDIA,IND,U8128685,20/08/1994,25/03/2031,False,0,4.584188,8465b96e-6dbd-4598-afa2-288fafd814d6,1b1aa0a9-3c81-4085-9d3f-fea236e16a19,,,,,,,,,,,,,,,,,,,,,,,,,,,,85690,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",SINDHU,F,F,X9579879,IND,BHARGAVI AMMA SANKARANARAYANAN POTTI,P<INDBHARGAVI<AMMA<SANKARANARAYANAN<POTTI<<SI,X9579879<3IND7705304F33051862065314368923<46,30/05/1977,19/05/2023,BHARGAVI AMMA SANKARANARAYANAN POTTI,18/05/2033,SANKARANARAYANAN POTTI,,BHARGAVI,SINDHU,30/05/1977,CHERUKOTUKONAM KERALA,TRIVANDRUM,18/05/2033,F,X9579879,INDIA,IND,X9579879,30/05/1977,18/05/2033,False,0,1.799336,3a311222-43b5-405a-a543-838c8f17b3c7,bf6b7940-c05b-4d74-bb4a-e247d9d8949a,,,,,,,,,,,,,,,,,,,,,,,,,,,,81939,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from a passport image using OCR tools and the rules provided. Here's a general approach:\n\n1. **Pre-process the Image:**\n   - Rotate and deskew the image if necessary.\n   - Enhance contrast and remove noise.\n\n2. **Run OCR:**\n   - Use a high-accuracy OCR tool to extract text from the image.\n\n3. **Extract MRZ:**\n   - Locate and extract the two lines of the MRZ (Machine Readable Zone).\n\n4. **Extract Fields:**\n   - Use the extracted text to fill in the fields such as number, country, name, surname, etc.\n   - Apply specific rules for each field as per the nationality-specific instructions.\n\n5. **Validate and Normalize:**\n   - Validate the extracted data against the rules provided.\n   - Normalize dates to DD/MM/YYYY format.\n   - Remove diacritics and replace special characters in names.\n\n6. **Construct JSON:**\n   - Assemble the extracted and validated data into the specified JSON format.\n\nIf you have access to OCR software, you can follow these steps to extract and process the data. If you need further assistance with specific steps, feel free to ask!\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from a passport image using OCR tools and the rules provided. Here's a general approach:

1. **Pre-process the Image:**
   - Rotate and deskew the image if necessary.
   - Enhance contrast and remove noise.

2. **Run OCR:**
   - Use a high-accuracy OCR tool to extract text from the image.

3. **Extract MRZ:**
   - Locate and extract the two lines of the MRZ (Machine Readable Zone).

4. **Extract Fields:**
   - Use the extracted text to fill in the fields such as number, country, name, surname, etc.
   - Apply specific rules for each field as per the nationality-specific instructions.

5. **Validate and Normalize:**
   - Validate the extracted data against the rules provided.
   - Normalize dates to DD/MM/YYYY format.
   - Remove diacritics and replace special characters in names.

6. **Construct JSON:**
   - Assemble the extracted and validated data into the specified JSON format.

If you have access to OCR software, you can follow these steps to extract and process the data. If you need further assistance with specific steps, feel free to ask!
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",JAMUNA,F,F,T9129296,IND,DEVI,P<INDDEVI<<JAMUNA<<<<<<<<<<<<<<<<<<<<<<<<<,T9129296<5IND7501090F2911272<<<<<<<<<<<<<<02,09/01/1975,28/11/2019,DEVI,27/11/2029,GYAN BAHADUR THAPA,,HUR,JAMUNA,09/01/1975,MANOHARPUR JHARKHAND,RANCHI,27/11/2029,F,T9129296,INDIA,IND,T9129296,09/01/1975,27/11/2029,False,0,12.665222,deedd431-3e96-45a3-a9d7-59e0dd76e8ac,319425a9-f53c-4242-a8f0-afe233a81ad7,,,,,,,,,,,,,,,,,,,,,,,,,,,,82289,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,,SHAILAJA,F,F,T2040047,IND,SHAILAJA,P<IND<SHAILAJA<<<<<<<<<<<<<<<<<<<<<<<<<,T20400476IND8005300F2904249<<<<<<<<<<,30/07/1980,25/04/2019,SHAILAJA,24/04/2029,VIJAYAN,,SANTHA,,30/07/1980,CHIRAYINKEEZHU KERALA,TRIVANDRUM,24/04/2029,F,T2040047,INDIA,IND,T2040047,30/07/1980,24/04/2029,False,0,15.182347,cb567528-437d-43d6-9f7e-eea765637e2d,1ff64a70-b2ed-45d0-a0b5-d22662e2ce7d,T2040047,T2040047,IND,IND,SHAILAJA,,,F,F,CHIRAYINKEEZHU KERALA,30/07/1980,30/07/1980,25/04/2019,24/04/2029,24/04/2029,SANTHA,VIJAYAN,TRIVANDRUM,INDIA,P<IND<SHAILAJA<<<<<<<<<<<<<<<<<<<<<<<<<,T20400476IND8005300F2904249<<<<<<<<<<,T2040047,30/07/1980,24/04/2029,F,SHAILAJA,,82617,"{""output"": NaN, ""original number"": ""T2040047"", ""number"": ""T2040047"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""SHAILAJA"", ""surname"": """", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""CHIRAYINKEEZHU KERALA"", ""original birth date"": ""30/07/1980"", ""birth date"": ""30/07/1980"", ""issue date"": ""25/04/2019"", ""original expiry date"": ""24/04/2029"", ""expiry date"": ""24/04/2029"", ""mother name"": ""SANTHA"", ""father name"": ""VIJAYAN"", ""place of issue"": ""TRIVANDRUM"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<IND<SHAILAJA<<<<<<<<<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""T20400476IND8005300F2904249<<<<<<<<<<"", ""mrzPassportNumber"": ""T2040047"", ""mrzDateOfBirth"": ""30/07/1980"", ""mrzDateOfExpiry"": ""24/04/2029"", ""mrzSex"": ""F"", ""mrzSurname"": ""SHAILAJA"", ""mrzGivenNames"": """"}"
,,LAKITA,F,F,T0034387,IND,SUBBA,INDSUBBA<<LAKITA,T00343876IND9001077F2812313<<<<<<<<<,07/01/1990,01/01/2019,SUBBA,31/12/2029,AMRIT SUBBA,,MANMAYA,LAKITA,07/01/1990,PULBAZAR WEST BENGAL,KOLKATA,31/12/2029,F,T0034387,INDIA,IND,T0034387,07/01/1990,31/12/2029,False,0,15.411096,07999b74-3417-417c-b752-6cf24c3e6c1a,a6c6eea3-1b8e-403e-b861-db4345a51a87,T0034387,T0034387,IND,IND,LAKITA,SUBBA,,F,F,PULBAZAR WEST BENGAL,07/01/1990,07/01/1990,01/01/2019,31/12/2029,31/12/2029,MANMAYA,AMRIT SUBBA,KOLKATA,INDIA,P<INDSUBBA<<LAKITA<<<<<<<<<<<<<<<<<<<<<,T00343876IND9001077F2812313<<<<<<<<<<,T0034387,07/01/1990,31/12/2029,F,SUBBA,LAKITA,85580,"{""output"": NaN, ""original number"": ""T0034387"", ""number"": ""T0034387"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""LAKITA"", ""surname"": ""SUBBA"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""PULBAZAR WEST BENGAL"", ""original birth date"": ""07/01/1990"", ""birth date"": ""07/01/1990"", ""issue date"": ""01/01/2019"", ""original expiry date"": ""31/12/2029"", ""expiry date"": ""31/12/2029"", ""mother name"": ""MANMAYA"", ""father name"": ""AMRIT SUBBA"", ""place of issue"": ""KOLKATA"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDSUBBA<<LAKITA<<<<<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""T00343876IND9001077F2812313<<<<<<<<<<"", ""mrzPassportNumber"": ""T0034387"", ""mrzDateOfBirth"": ""07/01/1990"", ""mrzDateOfExpiry"": ""31/12/2029"", ""mrzSex"": ""F"", ""mrzSurname"": ""SUBBA"", ""mrzGivenNames"": ""LAKITA""}"
,"OutputParserException(""Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from a passport image using OCR tools and the rules provided. Here's a general approach:\n\n1. **Pre-process the Image:**\n   - Rotate and deskew the image if necessary.\n   - Enhance contrast and remove noise.\n\n2. **Run OCR:**\n   - Use a high-accuracy OCR tool to extract text from the image.\n\n3. **Extract MRZ:**\n   - Locate the two-line MRZ at the bottom of the passport page.\n\n4. **Extract Fields:**\n   - **Number:** Extract from MRZ and OCR, validate, and choose the correct one.\n   - **Country:** Use the ISO 3166-1 alpha-3 code from MRZ or OCR.\n   - **Name and Surname:** Compare OCR and MRZ, use MRZ if they differ.\n   - **Gender:** Prefer MRZ if conflicting.\n   - **Birth Date:** Validate against MRZ and OCR, use MRZ if they differ.\n   - **Issue and Expiry Dates:** Extract from OCR, validate against MRZ.\n   - **Place of Birth and Issue:** Use OCR, apply specific rules for corrections.\n\n5. **Validate and Normalize:**\n   - Ensure all fields meet the specified format and rules.\n   - Remove diacritics and special characters as specified.\n\n6. **Construct JSON:**\n   - Assemble the extracted and validated data into the specified JSON format.\n\nIf you have access to OCR software, you can apply these steps to extract and validate the data from the passport image.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from a passport image using OCR tools and the rules provided. Here's a general approach:

1. **Pre-process the Image:**
   - Rotate and deskew the image if necessary.
   - Enhance contrast and remove noise.

2. **Run OCR:**
   - Use a high-accuracy OCR tool to extract text from the image.

3. **Extract MRZ:**
   - Locate the two-line MRZ at the bottom of the passport page.

4. **Extract Fields:**
   - **Number:** Extract from MRZ and OCR, validate, and choose the correct one.
   - **Country:** Use the ISO 3166-1 alpha-3 code from MRZ or OCR.
   - **Name and Surname:** Compare OCR and MRZ, use MRZ if they differ.
   - **Gender:** Prefer MRZ if conflicting.
   - **Birth Date:** Validate against MRZ and OCR, use MRZ if they differ.
   - **Issue and Expiry Dates:** Extract from OCR, validate against MRZ.
   - **Place of Birth and Issue:** Use OCR, apply specific rules for corrections.

5. **Validate and Normalize:**
   - Ensure all fields meet the specified format and rules.
   - Remove diacritics and special characters as specified.

6. **Construct JSON:**
   - Assemble the extracted and validated data into the specified JSON format.

If you have access to OCR software, you can apply these steps to extract and validate the data from the passport image.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",SINDHU,F,F,X5665401,IND,SUKUMARAN,P<INDSUKUMARAN<<SINDHU<<<<<<<<<<<<<<<<<<<<<<,X56654016IND7005285F2302025<<<<<<<<<<<<<<98,28/05/1970,02/02/2023,SUKUMARAN,01/02/2033,OMANAKUTTAN KUMARAN,,VIJAYAMMA,SINDHU,28/05/1970,CHATHANKARY KERALA,COCHIN,02/02/2033,F,X5665401,INDIA,IND,X5665401,28/05/1970,01/02/2033,False,0,15.785434,04d26b9c-bda7-4c43-8e37-2058becb1c59,776199a7-ca22-4dfe-b8d3-821252ea64cc,,,,,,,,,,,,,,,,,,,,,,,,,,,,85466,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,,RINA,F,F,V6289981,IND,HALDER,P<INDHALDER<RINA<<<<<<<<<<<<<<<<<<<<<<<<<,V6289981<8IND8404154F32022412073984064322<46,15/04/1984,25/02/2022,HALDER,24/02/2032,JAGANNATH HALDER,,SUMITRA,RINA,15/04/1984,KOLKATA WEST BENGAL,KOLKATA,24/02/2032,F,V6289981,INDIA,IND,V6289981,15/04/1984,24/02/2032,False,0,17.3254,5695ec9d-6cf9-4099-b130-5ef55363d598,340a9539-0ebf-441e-ac30-14a54e039228,V6289981,V6289981,IND,IND,RINA,HALDER,,F,F,KOLKATA WEST BENGAL,15/04/1984,15/04/1984,25/02/2022,24/02/2032,24/02/2032,SUMITRA,JAGANNATH HALDER,KOLKATA,INDIA,P<INDHALDER<RINA<<<<<<<<<<<<<<<<<<<<<<<<<,V6289981<8IND8404154F32022412073984064322<46,V6289981,15/04/1984,24/02/2032,F,HALDER,RINA,83492,"{""output"": NaN, ""original number"": ""V6289981"", ""number"": ""V6289981"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""RINA"", ""surname"": ""HALDER"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""KOLKATA WEST BENGAL"", ""original birth date"": ""15/04/1984"", ""birth date"": ""15/04/1984"", ""issue date"": ""25/02/2022"", ""original expiry date"": ""24/02/2032"", ""expiry date"": ""24/02/2032"", ""mother name"": ""SUMITRA"", ""father name"": ""JAGANNATH HALDER"", ""place of issue"": ""KOLKATA"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDHALDER<RINA<<<<<<<<<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""V6289981<8IND8404154F32022412073984064322<46"", ""mrzPassportNumber"": ""V6289981"", ""mrzDateOfBirth"": ""15/04/1984"", ""mrzDateOfExpiry"": ""24/02/2032"", ""mrzSex"": ""F"", ""mrzSurname"": ""HALDER"", ""mrzGivenNames"": ""RINA""}"
,,BEENA,F,F,V6572011,IND,ABRAHAM,P<INDABRAHAM<<BEENA<<<<<<<<<<<<<<<<<<<<<<<<<,V65720115IND8705183F3201101706386384322<<5,18/05/1987,11/01/2022,ABRAHAM,10/01/2032,ABRAHAM,,GRACY,BEENA,18/05/1987,MANNAR KERALA,COCHIN,10/01/2032,F,V6572011,INDIA,IND,V6572011,18/05/1987,10/01/2032,False,0,17.692575,d1635277-a71c-4589-bac7-2194f7acb3f3,a9a4222c-ace1-4591-a3c3-3ed27bcce4aa,V6572011,V6572011,IND,IND,BEENA,ABRAHAM,,F,F,MANNAR KERALA,18/05/1987,18/05/1987,11/01/2022,10/01/2032,10/01/2032,GRACY,ABRAHAM,COCHIN,INDIA,P<INDABRAHAM<<BEENA<<<<<<<<<<<<<<<<<<<<<<,V6572011<5IND8705183F32011017063863384322<<5,V6572011,18/05/1987,10/01/2032,F,ABRAHAM,BEENA,85246,"{""output"": NaN, ""original number"": ""V6572011"", ""number"": ""V6572011"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""BEENA"", ""surname"": ""ABRAHAM"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""MANNAR KERALA"", ""original birth date"": ""18/05/1987"", ""birth date"": ""18/05/1987"", ""issue date"": ""11/01/2022"", ""original expiry date"": ""10/01/2032"", ""expiry date"": ""10/01/2032"", ""mother name"": ""GRACY"", ""father name"": ""ABRAHAM"", ""place of issue"": ""COCHIN"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDABRAHAM<<BEENA<<<<<<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""V6572011<5IND8705183F32011017063863384322<<5"", ""mrzPassportNumber"": ""V6572011"", ""mrzDateOfBirth"": ""18/05/1987"", ""mrzDateOfExpiry"": ""10/01/2032"", ""mrzSex"": ""F"", ""mrzSurname"": ""ABRAHAM"", ""mrzGivenNames"": ""BEENA""}"
,,PRIYA,F,F,T8885054,IND,DHINESH,P<INDDHINESH<PRIYA<<<<<<<<<<<<<<<<<<<,T8885054<3IND8105129F2909129<<<<<<<<<<<<<,12/05/1981,13/09/2019,DHINESH,12/09/2029,CHANDRAN ULLAMKATTIL KUNJIKORAN,,LEELA,PRIYA,12/05/1981,ETTUMANA KERALA,COCHIN,12/09/2029,F,T8885054,INDIA,IND,T8885054,12/05/1981,12/09/2029,False,0,15.375139,85df3d59-2e28-4a24-abc9-89f18e47ce5d,23b9c845-945a-4a86-affe-6dca6df97b4c,T8885054,T8885054,IND,IND,PRIYA,DHINESH,,F,F,ETTUMANA KERALA,12/05/1981,12/05/1981,13/09/2019,12/09/2029,12/09/2029,LEELA,CHANDRAN ULLAMKATTIL KUNJIKORAN,COCHIN,INDIA,P<INDDHINESH<PRIYA<<<<<<<<<<<<<<<<<<<<<<,T8885054<3IND8105129F2909129<<<<<<<<<<,T8885054,12/05/1981,12/09/2029,F,DHINESH,PRIYA,85500,"{""output"": NaN, ""original number"": ""T8885054"", ""number"": ""T8885054"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""PRIYA"", ""surname"": ""DHINESH"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""ETTUMANA KERALA"", ""original birth date"": ""12/05/1981"", ""birth date"": ""12/05/1981"", ""issue date"": ""13/09/2019"", ""original expiry date"": ""12/09/2029"", ""expiry date"": ""12/09/2029"", ""mother name"": ""LEELA"", ""father name"": ""CHANDRAN ULLAMKATTIL KUNJIKORAN"", ""place of issue"": ""COCHIN"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDDHINESH<PRIYA<<<<<<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""T8885054<3IND8105129F2909129<<<<<<<<<<"", ""mrzPassportNumber"": ""T8885054"", ""mrzDateOfBirth"": ""12/05/1981"", ""mrzDateOfExpiry"": ""12/09/2029"", ""mrzSex"": ""F"", ""mrzSurname"": ""DHINESH"", ""mrzGivenNames"": ""PRIYA""}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",NALINI,F,F,Y4309172,IND,POOJARY,P<IND<NALINI<POOJARY,Y4309172<6IND8510172,17/10/1985,28/06/2024,POOJARY,27/06/2034,SANJEEVA POOJARY,,GULABI,NALINI,17/10/1985,KALLABETTU KARNATAKA,BENGALURU,27/06/2034,F,Y4309172,INDIA,IND,Y4309172,17/10/1985,27/06/2034,False,0,2.773688,4dc4f356-bdf8-4ae8-97fa-592c19080a9a,bd5b430d-b7f0-4478-819d-6e72586b2f41,,,,,,,,,,,,,,,,,,,,,,,,,,,,81838,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",SUNEETHA KUMARI,F,F,W2681508,IND,PALAPARTHI,P<INDPALAPARTHI<<SUNEETHA<KUMARI<<<<<<<<<<<<<<<<<,W26815084IND7906178F320622705C5040036122<04,17/06/1979,23/06/2022,PALAPARTHI,22/06/2032,SUDHAKAR RAO MATTHI,,,SUNEETHA KUMARI,17/06/1979,NARASAPURAM ANDHRA PRADESH,VISAKHAPATNAM,22/06/2032,F,W2681508,INDIA,IND,W2681508,17/06/1979,22/06/2032,False,0,3.331031,1002fe6d-ff79-4bc2-980a-07174d0a56ba,f5729eb7-02ae-4465-8b24-8fff762a3819,,,,,,,,,,,,,,,,,,,,,,,,,,,,85674,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from the passport image using OCR software and the rules provided. Here's a step-by-step approach:\n\n1. **Pre-process the Image:**\n   - Use image processing tools to auto-detect rotation/skew and deskew the image.\n   - Enhance contrast and de-noise the image using adaptive thresholding.\n\n2. **Run OCR:**\n   - Use a high-accuracy OCR engine to extract text from the passport image.\n\n3. **Extract MRZ:**\n   - Locate the two-line MRZ and extract exactly 44 characters for each line.\n\n4. **Field Extraction:**\n   - Extract fields such as number, country, name, surname, middle name, gender, place of birth, birth date, issue date, expiry date, place of issue, and country of issue.\n   - Use the rules provided to clean and validate each field.\n\n5. **Validation and Reconciliation:**\n   - Compare and validate fields against MRZ data.\n   - Use MRZ data to correct any discrepancies in the OCR data.\n\n6. **JSON Output:**\n   - Format the extracted and validated data into the specified JSON structure.\n\nIf you have access to OCR software, you can follow these steps to extract the data. If you need further assistance with specific steps or tools, feel free to ask!\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from the passport image using OCR software and the rules provided. Here's a step-by-step approach:

1. **Pre-process the Image:**
   - Use image processing tools to auto-detect rotation/skew and deskew the image.
   - Enhance contrast and de-noise the image using adaptive thresholding.

2. **Run OCR:**
   - Use a high-accuracy OCR engine to extract text from the passport image.

3. **Extract MRZ:**
   - Locate the two-line MRZ and extract exactly 44 characters for each line.

4. **Field Extraction:**
   - Extract fields such as number, country, name, surname, middle name, gender, place of birth, birth date, issue date, expiry date, place of issue, and country of issue.
   - Use the rules provided to clean and validate each field.

5. **Validation and Reconciliation:**
   - Compare and validate fields against MRZ data.
   - Use MRZ data to correct any discrepancies in the OCR data.

6. **JSON Output:**
   - Format the extracted and validated data into the specified JSON structure.

If you have access to OCR software, you can follow these steps to extract the data. If you need further assistance with specific steps or tools, feel free to ask!
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",REHANA ARIF,F,F,Y5525038,IND,SHAIKH,P<INDSHAIKH<<REHANA<ARIF<<<<<<<<<<<<<<<<<,Y5525038<2IND6901095F33060682078046964823<12,09/01/1969,07/06/2023,SHAIKH,06/06/2033,ABDULREHMAN,,AMINABEE,REHANA ARIF,09/01/1969,MUMBAI MAHARASHTRA,MUMBAI,06/06/2033,F,Y5525038,INDIA,IND,Y5525038,09/01/1969,06/06/2033,False,0,12.014321,e5b65ca5-0fb6-46c3-bb63-a2d8b6cd43bc,f1ab3527-f473-409b-ad4d-0106a34ede73,,,,,,,,,,,,,,,,,,,,,,,,,,,,85513,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,,PRAMILA SURAJ,F,F,C5532049,IND,POWAR,P<INDPOWAR<<PRAMILA<SURAJ<<<<<<<<<<<<<<<<<,C5532049<6IND9207112F3412097M060410951224<88,11/07/1992,10/12/2024,POWAR,09/12/2034,SUNIL SIDHU KHARAT,,REKHA,PRAMILA SURAJ,11/07/1992,BYAKUDU KARNATAKA,PUNE,09/12/2034,F,C5532049,INDIA,IND,C5532049,11/07/1992,09/12/2034,False,0,20.223971,ba725bde-7067-4791-b57f-4567b3f6fa01,def73f76-ffaa-4a6b-b455-ed34f80330e3,C5532049,C5532049,IND,IND,PRAMILA SURAJ,POWAR,,F,F,BYAKUDU KARNATAKA,11/07/1992,11/07/1992,10/12/2024,09/12/2034,09/12/2034,REKHA,SUNIL SIDIBHU KHARAT,PUNE,INDIA,P<INDPOWAR<<PRAMILA<SURAJ<<<<<<<<<<<<<<<<<,C5532049<6IND9207112F3412097M060410951224<88,C5532049,11/07/1992,09/12/2034,F,POWAR,PRAMILA SURAJ,83142,"{""output"": NaN, ""original number"": ""C5532049"", ""number"": ""C5532049"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""PRAMILA SURAJ"", ""surname"": ""POWAR"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""BYAKUDU KARNATAKA"", ""original birth date"": ""11/07/1992"", ""birth date"": ""11/07/1992"", ""issue date"": ""10/12/2024"", ""original expiry date"": ""09/12/2034"", ""expiry date"": ""09/12/2034"", ""mother name"": ""REKHA"", ""father name"": ""SUNIL SIDIBHU KHARAT"", ""place of issue"": ""PUNE"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDPOWAR<<PRAMILA<SURAJ<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""C5532049<6IND9207112F3412097M060410951224<88"", ""mrzPassportNumber"": ""C5532049"", ""mrzDateOfBirth"": ""11/07/1992"", ""mrzDateOfExpiry"": ""09/12/2034"", ""mrzSex"": ""F"", ""mrzSurname"": ""POWAR"", ""mrzGivenNames"": ""PRAMILA SURAJ""}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",KUNTIBAI,F,F,S3184414,IND,,P<INDKUNTIBAI<<<<<<<<<<<<<<<<<<<<<<<<<,S31844147IND7308244F2805287<<<<<<<<<<,24/08/1973,29/05/2018,KUNTIBAI,28/05/2028,SHANKAR LAL BRAJLA SALVI,,KAMLABAI,,24/08/1973,UJJAJN MADHYA PRADESH,DELHI,28/05/2028,F,S3184414,INDIA,IND,S3184414,24/08/1973,28/05/2028,False,0,5.2404,f2a49ec8-5ee9-44a4-8c06-d5de84f03865,3cb59a78-e571-4b44-bd7b-669e2ab1eb31,,,,,,,,,,,,,,,,,,,,,,,,,,,,82930,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from a passport image using OCR tools and the rules provided. Here's a step-by-step approach:\n\n1. **Pre-process the Image:**\n   - Auto-detect rotation/skew and deskew.\n   - Enhance contrast and de-noise.\n\n2. **Run OCR:**\n   - Use a high-accuracy OCR tool to extract text from the image.\n\n3. **Extract MRZ:**\n   - Locate the two-line MRZ and extract exactly 44 characters for each line.\n\n4. **Field Extraction:**\n   - Extract fields like number, country, name, surname, etc., using the rules provided.\n\n5. **Validation and Normalization:**\n   - Validate and normalize each field according to the specific rules for the nationality.\n\n6. **JSON Construction:**\n   - Construct a JSON object with the extracted and validated data.\n\nIf you have access to OCR software, you can follow these steps to extract the data. If you need further assistance with specific fields or rules, feel free to ask!\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from a passport image using OCR tools and the rules provided. Here's a step-by-step approach:

1. **Pre-process the Image:**
   - Auto-detect rotation/skew and deskew.
   - Enhance contrast and de-noise.

2. **Run OCR:**
   - Use a high-accuracy OCR tool to extract text from the image.

3. **Extract MRZ:**
   - Locate the two-line MRZ and extract exactly 44 characters for each line.

4. **Field Extraction:**
   - Extract fields like number, country, name, surname, etc., using the rules provided.

5. **Validation and Normalization:**
   - Validate and normalize each field according to the specific rules for the nationality.

6. **JSON Construction:**
   - Construct a JSON object with the extracted and validated data.

If you have access to OCR software, you can follow these steps to extract the data. If you need further assistance with specific fields or rules, feel free to ask!
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",RABEZA,F,F,Y8894555,IND,KHATUN,P<INDKHATUN<RABEZA<<<<<<<<<<<<<<<<<<<<<<<<<,Y8894555<0IND8501031F3309140<<<<<<<<<<<<<<08,03/01/1985,15/09/2023,KHATUN,14/09/2033,SABUR ALI BISWAS,,HASTYARJAN,RABEZA,03/01/1985,HADIPUR WEST BENGAL,KOLKATA,14/09/2033,F,Y8894555,INDIA,IND,Y8894555,03/01/1985,14/09/2033,False,0,10.115015,de801533-5125-48fd-9065-518495298e81,3f8ec5ba-3767-41da-a096-bd70be4c7e24,,,,,,,,,,,,,,,,,,,,,,,,,,,,84765,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,,KRISHNAPRIYA,F,F,T1844881,IND,NISHIN,P<INDNISHIN<<KRISHNAPRIYA<<<<<<<<<<<<<<<<<,T1844881<1IND9706017F2901077<<<<<<<<<<<<<<8,01/06/1997,10/01/2019,NISHIN,09/01/2029,SUNILKUMAR PONATH SUBRAHMANIAN,,SHEEBA,KRISHNAPRIYA,01/06/1997,KODUNGALLUR KERALA,COCHIN,09/01/2029,F,T1844881,INDIA,IND,T1844881,01/06/1997,09/01/2029,False,0,19.330276,6a1f379b-3069-4d26-976e-45abdc7b6d39,6e1b229d-a608-4c89-b60f-b6a1cc9cca39,T1844881,T1844881,IND,IND,KRISHNAPRIYA,NISHIN,,F,F,"KODUNGALLUR, KERALA",01/06/1997,01/06/1997,10/01/2019,09/01/2029,09/01/2029,SHEEBA,SUNILKUMAR PONATH SUBRAHMANIAN,COCHIN,INDIA,P<INDNISHIN<<KRISHNAPRIYA<<<<<<<<<<<<<<<<<,T1844881<1IND9706017F2901097<<<<<<<<<<<<<<8,T1844881,01/06/1997,09/01/2029,F,NISHIN,KRISHNAPRIYA,85624,"{""output"": NaN, ""original number"": ""T1844881"", ""number"": ""T1844881"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""KRISHNAPRIYA"", ""surname"": ""NISHIN"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""KODUNGALLUR, KERALA"", ""original birth date"": ""01/06/1997"", ""birth date"": ""01/06/1997"", ""issue date"": ""10/01/2019"", ""original expiry date"": ""09/01/2029"", ""expiry date"": ""09/01/2029"", ""mother name"": ""SHEEBA"", ""father name"": ""SUNILKUMAR PONATH SUBRAHMANIAN"", ""place of issue"": ""COCHIN"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDNISHIN<<KRISHNAPRIYA<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""T1844881<1IND9706017F2901097<<<<<<<<<<<<<<8"", ""mrzPassportNumber"": ""T1844881"", ""mrzDateOfBirth"": ""01/06/1997"", ""mrzDateOfExpiry"": ""09/01/2029"", ""mrzSex"": ""F"", ""mrzSurname"": ""NISHIN"", ""mrzGivenNames"": ""KRISHNAPRIYA""}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",REENA,F,F,V5664555,IND,MASEEH,P<INDMASEEHK<REENA<<<<<<<<<<<<<<<<<<<<<<<<<,V5664555<7IND8701015F3201313<<<<<<<<<<<<<<04,01/01/1987,01/02/2022,MASEEH,31/01/2032,,,,REENA,01/01/1987,BAREILLY,CHANDIGARH,31/01/2032,F,V5664555,INDIA,IND,V5664555,01/01/1987,31/01/2032,False,0,6.91998,f8fd23df-9ca3-4f6d-ab15-8db2ca78e6e7,dd8e6889-bd8a-4e63-85ec-e45dfe9b11eb,,,,,,,,,,,,,,,,,,,,,,,,,,,,85643,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from the passport image using OCR software and the rules provided. Here's a step-by-step approach:\n\n1. **Pre-process the Image:**\n   - Rotate and deskew the image if necessary.\n   - Enhance contrast and remove noise.\n\n2. **Run OCR:**\n   - Use high-accuracy OCR software to extract text from the image.\n\n3. **Extract MRZ:**\n   - Identify and extract the two lines of the MRZ from the bottom of the passport page.\n\n4. **Extract Fields:**\n   - **Number:** Extract from MRZ and OCR, validate, and choose the correct one.\n   - **Country:** Use the ISO 3166-1 alpha-3 code from MRZ or OCR.\n   - **Name and Surname:** Extract from both MRZ and OCR, clean, and validate.\n   - **Middle Name:** Follow specific rules for extraction.\n   - **Gender:** Prefer MRZ if conflicting.\n   - **Place of Birth and Issue:** Extract and clean according to rules.\n   - **Dates (Birth, Issue, Expiry):** Extract, validate, and format as DD/MM/YYYY.\n   - **Parental Names:** Extract from the additional info page if available.\n\n5. **Validate and Reconcile:**\n   - Cross-check MRZ and OCR data.\n   - Ensure logical consistency (e.g., expiry date > issue date  birth date).\n\n6. **Format as JSON:**\n   - Structure the extracted data into the specified JSON format.\n\nIf you have access to OCR software, you can follow these steps to extract and validate the data. If you need further assistance with specific steps, feel free to ask!\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from the passport image using OCR software and the rules provided. Here's a step-by-step approach:

1. **Pre-process the Image:**
   - Rotate and deskew the image if necessary.
   - Enhance contrast and remove noise.

2. **Run OCR:**
   - Use high-accuracy OCR software to extract text from the image.

3. **Extract MRZ:**
   - Identify and extract the two lines of the MRZ from the bottom of the passport page.

4. **Extract Fields:**
   - **Number:** Extract from MRZ and OCR, validate, and choose the correct one.
   - **Country:** Use the ISO 3166-1 alpha-3 code from MRZ or OCR.
   - **Name and Surname:** Extract from both MRZ and OCR, clean, and validate.
   - **Middle Name:** Follow specific rules for extraction.
   - **Gender:** Prefer MRZ if conflicting.
   - **Place of Birth and Issue:** Extract and clean according to rules.
   - **Dates (Birth, Issue, Expiry):** Extract, validate, and format as DD/MM/YYYY.
   - **Parental Names:** Extract from the additional info page if available.

5. **Validate and Reconcile:**
   - Cross-check MRZ and OCR data.
   - Ensure logical consistency (e.g., expiry date > issue date  birth date).

6. **Format as JSON:**
   - Structure the extracted data into the specified JSON format.

If you have access to OCR software, you can follow these steps to extract and validate the data. If you need further assistance with specific steps, feel free to ask!
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",LAKSHMI,F,F,V9998530,IND,MARIMUTHU,P<INDMARIMUTHU<<LAKSHMI<<<<<<<<<<<<<<<<<<<<<,V99985306IND8409078F2704232<<<<<<<<<<<<<<00,07/09/1984,28/04/2022,MARIMUTHU,27/04/2032,KRISHNAMOORTHI,,JOTHI,LAKSHMI,07/09/1984,KUMBAKONAM TAMIL NADU,TRICHY,27/04/2032,F,V9998530,INDIA,IND,V9998530,07/09/1984,27/04/2032,False,0,15.301166,14d0267c-4735-45a4-88a6-baceefd16cbc,1133cf59-9279-47ec-b25f-f65e259a51c6,,,,,,,,,,,,,,,,,,,,,,,,,,,,85645,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,,KUMARI,F,F,X5973322,IND,GUBBALA,P<INDGUBBALA<<KUMARI<<<<<<<<<<<<<<<<<<<<<<,X5973322<6IND7605105F3303012<<<<<<<<<<<<<<,10/05/1976,02/03/2023,GUBBALA,01/03/2033,NARASIMHAMURTHY VASARLA,,PALLALAMMA,KUMARI,10/05/1976,GODILANKA ANDHRA PRADESH,VISAKHAPATNAM,01/03/2033,F,X5973322,INDIA,IND,X5973322,10/05/1976,01/03/2033,False,0,16.936366,7ec285a3-6642-41f0-8c7b-580ea30232ff,126fd3c5-07f3-42c0-bc1a-70a79dd94935,X5973322,X5973322,IND,IND,KUMARI,GUBBALA,,F,F,GODILANKA ANDHRA PRADESH,10/05/1976,10/05/1976,02/03/2023,01/03/2033,01/03/2033,PALLALAMMA,NARASIMHAMURTHY VASARLA,VISAKHAPATNAM,INDIA,P<INDGUBBALA<<KUMARI<<<<<<<<<<<<<<<<<<<<<<<<<,X5973322<6IND7605105F3303012<<<<<<<<<<<<<<06,X5973322,10/05/1976,01/03/2033,F,GUBBALA,KUMARI,85626,"{""output"": NaN, ""original number"": ""X5973322"", ""number"": ""X5973322"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""KUMARI"", ""surname"": ""GUBBALA"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""GODILANKA ANDHRA PRADESH"", ""original birth date"": ""10/05/1976"", ""birth date"": ""10/05/1976"", ""issue date"": ""02/03/2023"", ""original expiry date"": ""01/03/2033"", ""expiry date"": ""01/03/2033"", ""mother name"": ""PALLALAMMA"", ""father name"": ""NARASIMHAMURTHY VASARLA"", ""place of issue"": ""VISAKHAPATNAM"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDGUBBALA<<KUMARI<<<<<<<<<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""X5973322<6IND7605105F3303012<<<<<<<<<<<<<<06"", ""mrzPassportNumber"": ""X5973322"", ""mrzDateOfBirth"": ""10/05/1976"", ""mrzDateOfExpiry"": ""01/03/2033"", ""mrzSex"": ""F"", ""mrzSurname"": ""GUBBALA"", ""mrzGivenNames"": ""KUMARI""}"
,"OutputParserException(""Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from the passport image using OCR tools and the rules provided. Here's a step-by-step approach:\n\n1. **Pre-process the Image:**\n   - Use image processing tools to auto-detect rotation/skew and deskew the image.\n   - Enhance contrast and de-noise the image using adaptive thresholding.\n\n2. **Run OCR:**\n   - Use a high-accuracy OCR engine to extract text from the image.\n\n3. **Extract MRZ:**\n   - Locate the two-line MRZ and extract exactly 44 characters for each line.\n\n4. **Field Extraction:**\n   - Extract fields such as number, country, name, surname, middle name, gender, place of birth, birth date, issue date, expiry date, place of issue, and country of issue.\n   - Use the rules provided to clean and validate each field.\n\n5. **Validation and Reconciliation:**\n   - Compare and validate fields against MRZ data.\n   - Use MRZ data to correct any discrepancies in OCR data.\n\n6. **JSON Output:**\n   - Format the extracted and validated data into the specified JSON structure.\n\nIf you have access to OCR software, you can apply these steps to extract the data from the passport image. If you need further assistance with specific steps, feel free to ask!\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from the passport image using OCR tools and the rules provided. Here's a step-by-step approach:

1. **Pre-process the Image:**
   - Use image processing tools to auto-detect rotation/skew and deskew the image.
   - Enhance contrast and de-noise the image using adaptive thresholding.

2. **Run OCR:**
   - Use a high-accuracy OCR engine to extract text from the image.

3. **Extract MRZ:**
   - Locate the two-line MRZ and extract exactly 44 characters for each line.

4. **Field Extraction:**
   - Extract fields such as number, country, name, surname, middle name, gender, place of birth, birth date, issue date, expiry date, place of issue, and country of issue.
   - Use the rules provided to clean and validate each field.

5. **Validation and Reconciliation:**
   - Compare and validate fields against MRZ data.
   - Use MRZ data to correct any discrepancies in OCR data.

6. **JSON Output:**
   - Format the extracted and validated data into the specified JSON structure.

If you have access to OCR software, you can apply these steps to extract the data from the passport image. If you need further assistance with specific steps, feel free to ask!
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",RADHIKA SANJAY,F,F,U5812481,IND,NANDLASKAR,P<INDNANDLASKAR<<RADHIKA<SANJAY<<<<<<<<<<<<<<<<<,U5812481<9IND7408169F3104275<<<<<<<<<<<<<<04,16/08/1974,28/04/2021,NANDLASKAR,27/04/2031,KRISHNA SHANKAR RAHATE,,SHUBHANGI,RADHIKA SANJAY,16/08/1974,VASAI MAHARASHTRA,MUMBAI,27/04/2031,F,U5812481,INDIA,IND,U5812481,16/08/1974,27/04/2031,False,0,18.752196,ef4bead3-9cb9-491e-ad1c-8c8d767ff593,a7f3f76c-eb25-4e81-9206-76412dc94edc,,,,,,,,,,,,,,,,,,,,,,,,,,,,85505,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",THIHAL,F,F,C8162919,IND,SHAIK KEELAGONTHU,P<INDSHAIK<KEELAGONTHU<THIHAL<<<<<<<<<<<<<<,C8162919<IND0510143F35013021067348022525<90,14/10/2005,31/01/2025,SHAIK KEELAGONTHU,30/01/2035,KARIMULLA SHAIK KEELAGONTHU,,RESMA,THIHAL,14/10/2005,OBILI ANDHRA PRADESH,CHENNAI,30/01/2035,F,C8162919,INDIA,IND,C8162919,14/10/2005,30/01/2035,False,0,20.880244,06cae91d-e38d-4faa-8ce0-ea14b369c3c9,76b1389e-3b8f-4e85-a7fa-9f7fb2d6cc8d,,,,,,,,,,,,,,,,,,,,,,,,,,,,87513,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",LATHA,F,F,C5993497,IND,SUBHASH,P<INDSUBHASH<<LATHA<<<<<<<<<<<<<<<<<<<<<<,C5993497<8IND7705289F34121672067212891924<74,28/05/1977,17/12/2024,SUBHASH,16/12/2034,KUMARAN,,PADMAVATHY,LATHA,28/05/1977,CHUVANNUMMANNU KERALA,COCHIN,16/12/2034,F,C5993497,INDIA,IND,C5993497,28/05/1977,16/12/2034,False,0,30.980817,462776d8-62ce-442d-a00e-7a2b7cdcfe4f,d88958d7-5faa-4d8d-ae13-3a4bc772a4a9,,,,,,,,,,,,,,,,,,,,,,,,,,,,83874,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,,VARSHA MANGESH,F,F,V4740379,IND,KALE,P<INDKALE<<VARSHA<MANGESH<<<<<<<<<<<<<<<<<,V47403793IND0205012F311125306585569821<<50,01/05/2005,26/11/2021,KALE,25/11/2031,MANGESH HIRAJI KALE,,SARITA,VARSHA MANGESH,01/05/2005,MUMBAI MAHARASHTRA,MUMBAI,25/11/2031,F,V4740379,INDIA,IND,V4740379,01/05/2005,25/11/2031,False,0,31.200425,0d77c034-4847-4d22-8535-c1048680331e,c1550952-23a8-4f47-84f2-782ec2ac2393,V4740379,V4740379,IND,IND,VARSHA MANGESH,KALE,,F,F,MUMBAI MAHARASHTRA,01/05/2005,01/05/2005,26/11/2021,25/11/2031,25/11/2031,SARITA,MANGESH HIRAJI KALE,MUMBAI,INDIA,P<INDKALE<VARSHA<MANGESH<<<<<<<<<<<<<<<<<,V47403793IND0205012F31112533068556859821<<50,V4740379,01/05/2002,25/11/2031,F,KALE,VARSHA MANGESH,85679,"{""output"": NaN, ""original number"": ""V4740379"", ""number"": ""V4740379"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""VARSHA MANGESH"", ""surname"": ""KALE"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""MUMBAI MAHARASHTRA"", ""original birth date"": ""01/05/2005"", ""birth date"": ""01/05/2005"", ""issue date"": ""26/11/2021"", ""original expiry date"": ""25/11/2031"", ""expiry date"": ""25/11/2031"", ""mother name"": ""SARITA"", ""father name"": ""MANGESH HIRAJI KALE"", ""place of issue"": ""MUMBAI"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDKALE<VARSHA<MANGESH<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""V47403793IND0205012F31112533068556859821<<50"", ""mrzPassportNumber"": ""V4740379"", ""mrzDateOfBirth"": ""01/05/2002"", ""mrzDateOfExpiry"": ""25/11/2031"", ""mrzSex"": ""F"", ""mrzSurname"": ""KALE"", ""mrzGivenNames"": ""VARSHA MANGESH""}"
,,SANTHAKUMARI,F,F,B8950324,IND,PULIKKATHODI,P<INDPULIKKATHODI<<SANTHAKUMARI<<<<<<<<<<<<<<<<<,B8950324<4IND7005235F33122675066078740523<96,23/05/1970,27/12/2023,PULIKKATHODI,26/12/2033,ERAYACHAN,,ELIAMMA,SANTHAKUMARI,23/05/1970,WAYANAD KERALA,KOZHIKODE,26/12/2033,F,B8950324,INDIA,IND,B8950324,23/05/1970,26/12/2033,False,0,29.412876,4f18480d-3954-4ff7-b1f3-0d1b22e1e316,092469fd-62b4-491d-b2a7-8189a498ddd4,B8950324,B8950324,IND,IND,SANTHAKUMARI,PULIKKATHODI,,F,F,WAYANAD KERALA,23/05/1970,23/05/1970,27/12/2023,26/12/2033,26/12/2033,ELIAMMA,ERAYACHAN,KOZHIKODE,INDIA,P<INDPULIKKATHODI<<SANTHAKUMARI<<<<<<<<<<<<<<,B8950324<4IND7005235F33122675066078740523<96,B8950324,23/05/1970,26/12/2033,F,PULIKKATHODI,SANTHAKUMARI,85520,"{""output"": NaN, ""original number"": ""B8950324"", ""number"": ""B8950324"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""SANTHAKUMARI"", ""surname"": ""PULIKKATHODI"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""WAYANAD KERALA"", ""original birth date"": ""23/05/1970"", ""birth date"": ""23/05/1970"", ""issue date"": ""27/12/2023"", ""original expiry date"": ""26/12/2033"", ""expiry date"": ""26/12/2033"", ""mother name"": ""ELIAMMA"", ""father name"": ""ERAYACHAN"", ""place of issue"": ""KOZHIKODE"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDPULIKKATHODI<<SANTHAKUMARI<<<<<<<<<<<<<<"", ""mrzLine2"": ""B8950324<4IND7005235F33122675066078740523<96"", ""mrzPassportNumber"": ""B8950324"", ""mrzDateOfBirth"": ""23/05/1970"", ""mrzDateOfExpiry"": ""26/12/2033"", ""mrzSex"": ""F"", ""mrzSurname"": ""PULIKKATHODI"", ""mrzGivenNames"": ""SANTHAKUMARI""}"
,,DAKSHATA DINESH,F,F,W1827622,IND,TAMBE,P<INDTAMBE<<DAKSHATA<DINESH<<<<<<<<<<<<<<<<,W1827622<6IND7812260F3206295<<<<<<<<<<<<<<08,26/12/1978,30/06/2022,TAMBE,29/06/2032,DINESH RAMCHANDRA TAMBE,,SAROJINI,DAKSHATA DINESH,26/12/1978,MUMBAI MAHARASHTRA,MUMBAI,29/06/2032,F,W1827622,INDIA,IND,W1827622,26/12/1978,29/06/2032,False,0,26.957126,208dcfce-1a38-40ce-9cac-263ab3fcaf20,90aefb47-5d02-4bf0-a0ab-1a0e3dbb1d48,W1827622,W1827622,IND,IND,DAKSHATA DINESH,TAMBE,,F,F,MUMBAI MAHARASHTRA,26/12/1978,26/12/1978,30/06/2022,29/06/2032,29/06/2032,SAROJINI,DINESH RAMCHANDRA TAMBE,MUMBAI,INDIA,P<INDTAMBE<<DAKSHATA<DINESH<<<<<<<<<<<<<<<<<,W18276226IND7812260F3206295<<<<<<<<<<<<<<08,W1827622,26/12/1978,29/06/2032,F,TAMBE,DAKSHATA DINESH,85434,"{""output"": NaN, ""original number"": ""W1827622"", ""number"": ""W1827622"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""DAKSHATA DINESH"", ""surname"": ""TAMBE"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""MUMBAI MAHARASHTRA"", ""original birth date"": ""26/12/1978"", ""birth date"": ""26/12/1978"", ""issue date"": ""30/06/2022"", ""original expiry date"": ""29/06/2032"", ""expiry date"": ""29/06/2032"", ""mother name"": ""SAROJINI"", ""father name"": ""DINESH RAMCHANDRA TAMBE"", ""place of issue"": ""MUMBAI"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDTAMBE<<DAKSHATA<DINESH<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""W18276226IND7812260F3206295<<<<<<<<<<<<<<08"", ""mrzPassportNumber"": ""W1827622"", ""mrzDateOfBirth"": ""26/12/1978"", ""mrzDateOfExpiry"": ""29/06/2032"", ""mrzSex"": ""F"", ""mrzSurname"": ""TAMBE"", ""mrzGivenNames"": ""DAKSHATA DINESH""}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",JARINA BANU,F,F,W9617199,IND,MOHAMED MYDEEN,P<INDMOHAMED<MYDEEN<JARINA<BANU<<<<<<<<<<<<<,W96171996IND6702171F3302233075087631123<76,17/02/1967,24/02/2023,MOHAMED MYDEEN,23/02/2033,MOHAMED MYDEEN,,,JARINA BANU,17/02/1967,MELAPALAYAM TAMIL NADU,MADURAI,23/02/2033,F,W9617199,INDIA,IND,W9617199,17/02/1967,23/02/2033,False,0,21.947143,8ffd3d5f-744b-46e6-9cda-69514f247750,22354f07-80a4-4851-8bcd-2b56b98c4a2a,,,,,,,,,,,,,,,,,,,,,,,,,,,,82818,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from the passport image using OCR software and the rules provided. Here's a step-by-step approach:\n\n1. **Pre-process the Image:**\n   - Use image processing tools to auto-detect rotation/skew and deskew the image.\n   - Enhance contrast and de-noise using adaptive thresholding.\n\n2. **Run OCR:**\n   - Use a high-accuracy OCR engine to extract text from the passport image.\n\n3. **Extract MRZ:**\n   - Locate the two-line MRZ and store exactly 44 characters each as `mrzLine1` and `mrzLine2`.\n\n4. **Field Extraction & Normalization:**\n   - Extract fields such as `number`, `country`, `name`, `surname`, `middle name`, `gender`, `place of birth`, `birth date`, `issue date`, `expiry date`, `mother name`, `father name`, `place of issue`, `country of issue`, `mrzPassportNumber`, `mrzDateOfBirth`, `mrzDateOfExpiry`, `mrzSex`, `mrzSurname`, and `mrzGivenNames`.\n   - Apply the specific rules for each field as outlined in the instructions.\n\n5. **Validation & Reconciliation:**\n   - Validate extracted data against MRZ data.\n   - Use MRZ data to correct any discrepancies in the OCR data.\n\n6. **Output JSON:**\n   - Assemble the extracted and validated data into a JSON object with the specified structure.\n\nIf you have access to OCR software, you can follow these steps to extract and validate the data. If you need further assistance with specific steps, feel free to ask!\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from the passport image using OCR software and the rules provided. Here's a step-by-step approach:

1. **Pre-process the Image:**
   - Use image processing tools to auto-detect rotation/skew and deskew the image.
   - Enhance contrast and de-noise using adaptive thresholding.

2. **Run OCR:**
   - Use a high-accuracy OCR engine to extract text from the passport image.

3. **Extract MRZ:**
   - Locate the two-line MRZ and store exactly 44 characters each as `mrzLine1` and `mrzLine2`.

4. **Field Extraction & Normalization:**
   - Extract fields such as `number`, `country`, `name`, `surname`, `middle name`, `gender`, `place of birth`, `birth date`, `issue date`, `expiry date`, `mother name`, `father name`, `place of issue`, `country of issue`, `mrzPassportNumber`, `mrzDateOfBirth`, `mrzDateOfExpiry`, `mrzSex`, `mrzSurname`, and `mrzGivenNames`.
   - Apply the specific rules for each field as outlined in the instructions.

5. **Validation & Reconciliation:**
   - Validate extracted data against MRZ data.
   - Use MRZ data to correct any discrepancies in the OCR data.

6. **Output JSON:**
   - Assemble the extracted and validated data into a JSON object with the specified structure.

If you have access to OCR software, you can follow these steps to extract and validate the data. If you need further assistance with specific steps, feel free to ask!
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",JINITA,F,F,X4497553,IND,BARAILY,P<INDBARAILY<JINITA<<<<<<<<<<<<<<<<<<<<<<,X4497553<1IND7809073F2603276<<<<<<<<<<<<<<04,07/09/1978,28/03/2024,BARAILY,27/03/2026,BINOD PRATYAR,,BHAGI,JINITA,07/09/1978,BADAMTAM T E WEST BENGAL,DUBAI,27/03/2026,F,X4497553,UAE,IND,X4497553,07/09/1978,27/03/2026,False,0,32.595632,83b92c7c-24f8-45cd-ac6d-2a46181bc160,8eff16d2-4aee-4774-a425-8a2c80ee7328,,,,,,,,,,,,,,,,,,,,,,,,,,,,86317,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"RateLimitError(""Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4o in organization org-yqYoxY18hi8W4vEGmsvVjL9l on tokens per min (TPM): Limit 800000, Used 796276, Requested 46005. Please try again in 3.171s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}"")

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 201, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 186, in _invoke
    for attempt in self._sync_retrying(reraise=True):
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 420, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 187, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/concurrent/futures/_base.py"", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/concurrent/futures/_base.py"", line 401, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 188, in _invoke
    result = super().invoke(
             ^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 5416, in invoke
    return self.bound.invoke(
           ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 369, in invoke
    self.generate_prompt(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 946, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 765, in generate
    self._generate_with_cache(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 1011, in _generate_with_cache
    result = self._generate(
             ^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_openai/chat_models/base.py"", line 991, in _generate
    response = self.client.create(**payload)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_utils/_utils.py"", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/resources/chat/completions/completions.py"", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_base_client.py"", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_base_client.py"", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4o in organization org-yqYoxY18hi8W4vEGmsvVjL9l on tokens per min (TPM): Limit 800000, Used 796276, Requested 46005. Please try again in 3.171s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}
",JYOTIBEN NANJIBHAI,F,F,N5766048,IND,SOLANKI,P<INDSOLANKI<<JYOTIBEN<NANJIBHAI<<<<<<<<<<<<<<<<<,N5766048<5IND7512028F2512086<<<<<<<<<<<<<<04,02/12/1975,09/12/2015,SOLANKI,08/12/2025,NANJIBHAI ASHABHAI SOLANKI,,BHANUBEN,JYOTIBEN NANJIBHAI,02/12/1975,KHEDA GUJARAT,AHMEDABAD,08/12/2025,F,N5766048,INDIA,IND,N5766048,02/12/1975,08/12/2025,False,0,43.211401,56cc6c89-1a24-42fb-8c2c-a101f066aa05,801f2271-267e-4520-b391-3199495e23a4,,,,,,,,,,,,,,,,,,,,,,,,,,,,85605,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,,RITU,F,F,W1135815,IND,SETHI,P<IND<RITU<SETHI<<<<<<<<<<<<<<<<<<<<<,W1135815<4IND9411210F32062385066492325622<82,21/11/1994,24/06/2022,SETHI,23/06/2032,RAJ KUMAR,,SARITA,RITU,21/11/1994,PHAGWARA PUNJAB,JALANDHAR,23/06/2032,F,W1135815,INDIA,IND,W1135815,21/11/1994,23/06/2032,False,0,55.308873,2608cda4-166d-455b-9e5e-6e5325e7ff81,6c2c66d5-2489-431e-85ed-d5550ec750e6,W1135815,W1135815,IND,IND,RITU,SETHI,,F,F,PHAGWARA PUNJAB,21/11/1994,21/11/1994,24/06/2022,23/06/2032,23/06/2032,SARITA,RAJ KUMAR,JALANDHAR,INDIA,P<IND<RITU<SETHI<<<<<<<<<<<<<<<<<<<<<,W1135815<4IND9411210F32062385066492325622<82,W1135815,21/11/1994,23/06/2032,F,SETHI,RITU,85648,"{""output"": NaN, ""original number"": ""W1135815"", ""number"": ""W1135815"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""RITU"", ""surname"": ""SETHI"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""PHAGWARA PUNJAB"", ""original birth date"": ""21/11/1994"", ""birth date"": ""21/11/1994"", ""issue date"": ""24/06/2022"", ""original expiry date"": ""23/06/2032"", ""expiry date"": ""23/06/2032"", ""mother name"": ""SARITA"", ""father name"": ""RAJ KUMAR"", ""place of issue"": ""JALANDHAR"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<IND<RITU<SETHI<<<<<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""W1135815<4IND9411210F32062385066492325622<82"", ""mrzPassportNumber"": ""W1135815"", ""mrzDateOfBirth"": ""21/11/1994"", ""mrzDateOfExpiry"": ""23/06/2032"", ""mrzSex"": ""F"", ""mrzSurname"": ""SETHI"", ""mrzGivenNames"": ""RITU""}"
,"OutputParserException('Invalid json output: I\'m unable to process images directly. However, I can guide you on how to extract the necessary information from the passport image using OCR software and the rules provided. Here\'s a step-by-step guide:\n\n1. **Pre-process the Image:**\n   - Use image processing tools to auto-detect rotation/skew and deskew the image.\n   - Enhance contrast and de-noise the image using adaptive thresholding.\n\n2. **Run OCR:**\n   - Use a high-accuracy OCR tool to extract text from the image.\n\n3. **Extract Fields:**\n   - **Number:** Extract from the MRZ (positions 1-9 of `mrzLine2`) and OCR. Validate and choose the correct one.\n   - **Country:** Extract the ISO 3166-1 alpha-3 code from OCR or MRZ.\n   - **Name and Surname:** Extract from OCR and MRZ. Use MRZ if they differ.\n   - **Middle Name:** Always set to """" for Indian passports.\n   - **Gender:** Prefer MRZ if conflicting.\n   - **Place of Birth:** Extract from OCR, apply cleaning rules.\n   - **Birth Date:** Extract from OCR and MRZ, use MRZ if they differ.\n   - **Issue Date:** Extract only from the OCR ""Date of Issue"" field.\n   - **Expiry Date:** Extract from OCR and MRZ, use MRZ if they differ.\n   - **Place of Issue and Country of Issue:** Extract from OCR, apply specific rules for Indian passports.\n   - **Parental Data:** Extract from Page 2 of the passport.\n\n4. **MRZ Extraction:**\n   - Extract `mrzLine1` and `mrzLine2` from the image.\n   - Parse and validate MRZ fields: `mrzPassportNumber`, `mrzDateOfBirth`, `mrzDateOfExpiry`, `mrzSex`, `mrzSurname`, `mrzGivenNames`.\n\n5. **Validation and Reconciliation:**\n   - Compare and reconcile data between OCR and MRZ.\n   - Ensure logical order: `birth date` <= `issue date` < `expiry date`.\n\n6. **Final JSON Construction:**\n   - Assemble the final JSON object with validated data.\n   - Ensure all fields are in the specified order and format.\n\n7. **Output:**\n   - Return the final JSON object.\n\nIf you have access to OCR software, you can follow these steps to extract and validate the data. If you need further assistance with specific fields, feel free to ask!\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE ')

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from the passport image using OCR software and the rules provided. Here's a step-by-step guide:

1. **Pre-process the Image:**
   - Use image processing tools to auto-detect rotation/skew and deskew the image.
   - Enhance contrast and de-noise the image using adaptive thresholding.

2. **Run OCR:**
   - Use a high-accuracy OCR tool to extract text from the image.

3. **Extract Fields:**
   - **Number:** Extract from the MRZ (positions 1-9 of `mrzLine2`) and OCR. Validate and choose the correct one.
   - **Country:** Extract the ISO 3166-1 alpha-3 code from OCR or MRZ.
   - **Name and Surname:** Extract from OCR and MRZ. Use MRZ if they differ.
   - **Middle Name:** Always set to """" for Indian passports.
   - **Gender:** Prefer MRZ if conflicting.
   - **Place of Birth:** Extract from OCR, apply cleaning rules.
   - **Birth Date:** Extract from OCR and MRZ, use MRZ if they differ.
   - **Issue Date:** Extract only from the OCR ""Date of Issue"" field.
   - **Expiry Date:** Extract from OCR and MRZ, use MRZ if they differ.
   - **Place of Issue and Country of Issue:** Extract from OCR, apply specific rules for Indian passports.
   - **Parental Data:** Extract from Page 2 of the passport.

4. **MRZ Extraction:**
   - Extract `mrzLine1` and `mrzLine2` from the image.
   - Parse and validate MRZ fields: `mrzPassportNumber`, `mrzDateOfBirth`, `mrzDateOfExpiry`, `mrzSex`, `mrzSurname`, `mrzGivenNames`.

5. **Validation and Reconciliation:**
   - Compare and reconcile data between OCR and MRZ.
   - Ensure logical order: `birth date` <= `issue date` < `expiry date`.

6. **Final JSON Construction:**
   - Assemble the final JSON object with validated data.
   - Ensure all fields are in the specified order and format.

7. **Output:**
   - Return the final JSON object.

If you have access to OCR software, you can follow these steps to extract and validate the data. If you need further assistance with specific fields, feel free to ask!
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",RANU,F,F,T8462596,IND,HALDER,P<INDHALDER<RANU<<<<<<<<<<<<<<<<<<<<<<,T8462596<IND8801018F2909266<<<<<<<<<<,01/01/1988,27/09/2019,HALDER,26/09/2029,MUJID HALDER,,BANU,RANU,01/01/1988,BHANDAKURRA WEST BENGAL,KOLKATA,26/09/2029,F,T8462596,INDIA,IND,T8462596,01/01/1988,26/09/2029,False,0,27.364267,7e433f7e-31d2-4417-8f56-cfda42d6daaf,d29bbb97-e97d-439d-b476-b5dbe18fe06a,,,,,,,,,,,,,,,,,,,,,,,,,,,,87210,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,,JYOTI,F,F,U6815453,IND,,P<IND<JYOTI<<<<<<<<<<<<<<<<<<<<<<<<<,U6815453<6IND0109040F3002119<<<<<<<<<<<<<<08,04/09/2001,12/02/2020,,11/02/2030,ASHOK KUMAR,,RUBY,JYOTI,04/09/2001,CHANDIGARH,CHANDIGARH,11/02/2030,F,U6815453,INDIA,IND,U6815453,04/09/2001,11/02/2030,False,0,23.168421,e866d3b1-c6bc-4ece-bcb1-aa3541cf7928,b59457a6-cd4b-4096-b13a-c27fdf8183bb,U6815453,U6815453,IND,IND,JYOTI,,,F,F,CHANDIGARH,04/09/2001,04/09/2001,12/02/2020,11/02/2030,11/02/2030,RUBY,ASHOK KUMAR,CHANDIGARH,INDIA,P<IND<JYOTI<<<<<<<<<<<<<<<<<<<<<<<<<,U6815453<6IND0109040F3002119<<<<<<<<<<<<<8,U6815453,04/09/2001,11/02/2030,F,,JYOTI,85487,"{""output"": NaN, ""original number"": ""U6815453"", ""number"": ""U6815453"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""JYOTI"", ""surname"": """", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""CHANDIGARH"", ""original birth date"": ""04/09/2001"", ""birth date"": ""04/09/2001"", ""issue date"": ""12/02/2020"", ""original expiry date"": ""11/02/2030"", ""expiry date"": ""11/02/2030"", ""mother name"": ""RUBY"", ""father name"": ""ASHOK KUMAR"", ""place of issue"": ""CHANDIGARH"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<IND<JYOTI<<<<<<<<<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""U6815453<6IND0109040F3002119<<<<<<<<<<<<<8"", ""mrzPassportNumber"": ""U6815453"", ""mrzDateOfBirth"": ""04/09/2001"", ""mrzDateOfExpiry"": ""11/02/2030"", ""mrzSex"": ""F"", ""mrzSurname"": """", ""mrzGivenNames"": ""JYOTI""}"
,,SUDHA,F,F,C6901139,IND,POTHADIPARAMBIL VIJAYAN,P<INDPOTHADIPARAMBIL<VIJAYAN<SUDHA<<<<<<<<<<<<<<,C6901139<3IND6701011F3412293<<<<<<<<<<<<<<02,01/01/1967,30/12/2024,POTHADIPARAMBIL VIJAYAN,29/12/2034,BABU PADATHARA JANAKI,,SUBHASHINI,SUDHA,01/01/1967,ERNAKULAM KERALA,COCHIN,29/12/2034,F,C6901139,INDIA,IND,C6901139,01/01/1967,29/12/2034,False,0,39.245464,06049437-a917-4ee4-b515-317d8609b89a,8c804b15-92c0-480f-89d6-97ef9787e621,C6901139,C6901139,IND,IND,SUDHA,POTHADIPARAMBIL VIJAYAN,,F,F,ERNAKULAM KERALA,01/01/1967,01/01/1967,30/12/2024,29/12/2034,29/12/2034,SUBHASHINI,BABU PADATHARA JANAKI,COCHIN,INDIA,P<INDPOTHADIPARAMBIL<VIJAYAN<SUDHA<<<<<<<<<<<<<<,C6901139<3IND6701011F3412293<<<<<<<<<<<<<<02,C6901139,01/01/1967,29/12/2034,F,POTHADIPARAMBIL VIJAYAN,SUDHA,81472,"{""output"": NaN, ""original number"": ""C6901139"", ""number"": ""C6901139"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""SUDHA"", ""surname"": ""POTHADIPARAMBIL VIJAYAN"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""ERNAKULAM KERALA"", ""original birth date"": ""01/01/1967"", ""birth date"": ""01/01/1967"", ""issue date"": ""30/12/2024"", ""original expiry date"": ""29/12/2034"", ""expiry date"": ""29/12/2034"", ""mother name"": ""SUBHASHINI"", ""father name"": ""BABU PADATHARA JANAKI"", ""place of issue"": ""COCHIN"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDPOTHADIPARAMBIL<VIJAYAN<SUDHA<<<<<<<<<<<<<<"", ""mrzLine2"": ""C6901139<3IND6701011F3412293<<<<<<<<<<<<<<02"", ""mrzPassportNumber"": ""C6901139"", ""mrzDateOfBirth"": ""01/01/1967"", ""mrzDateOfExpiry"": ""29/12/2034"", ""mrzSex"": ""F"", ""mrzSurname"": ""POTHADIPARAMBIL VIJAYAN"", ""mrzGivenNames"": ""SUDHA""}"
,,JEENA,F,F,Y7078781,IND,KOILERIYAN,P<INDKOILERIYAN<JEENA<<<<<<<<<<<<<<<<<<<,Y7078781<8IND8603289F3307249107597010233,28/03/1986,25/07/2023,KOILERIYAN,24/07/2033,CHANDRAN KOILERIYAN,,VINODINI,JEENA,28/03/1986,KANNUR KERALA,KOZHIKODE,24/07/2033,F,Y7078781,INDIA,IND,Y7078781,28/03/1986,24/07/2033,False,0,37.427168,d58f3542-e89d-47de-8bd0-d37dac56bf25,c81016a6-b1cd-42a7-8e5d-5299fdfe3e42,Y7078781,Y7078781,IND,IND,JEENA,KOILERIYAN,,F,F,KANNUR KERALA,28/03/1986,28/03/1986,25/07/2023,24/07/2033,24/07/2033,VINODINI,CHANDRAN KOILERIYAN,KOZHIKODE,INDIA,P<INDKOILERIYAN<JEENA<<<<<<<<<<<<<<<<<<<<<<<<<,Y7078781<8IND8603289F3307249107597010213<<<<<<,Y7078781,28/03/1986,24/07/2033,F,KOILERIYAN,JEENA,82345,"{""output"": NaN, ""original number"": ""Y7078781"", ""number"": ""Y7078781"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""JEENA"", ""surname"": ""KOILERIYAN"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""KANNUR KERALA"", ""original birth date"": ""28/03/1986"", ""birth date"": ""28/03/1986"", ""issue date"": ""25/07/2023"", ""original expiry date"": ""24/07/2033"", ""expiry date"": ""24/07/2033"", ""mother name"": ""VINODINI"", ""father name"": ""CHANDRAN KOILERIYAN"", ""place of issue"": ""KOZHIKODE"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDKOILERIYAN<JEENA<<<<<<<<<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""Y7078781<8IND8603289F3307249107597010213<<<<<<"", ""mrzPassportNumber"": ""Y7078781"", ""mrzDateOfBirth"": ""28/03/1986"", ""mrzDateOfExpiry"": ""24/07/2033"", ""mrzSex"": ""F"", ""mrzSurname"": ""KOILERIYAN"", ""mrzGivenNames"": ""JEENA""}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",SUNITHA,F,F,Y7288676,IND,BABU,P<INDBABU<<SUNITHA<<<<<<<<<<<<<<<<<<<<<<<<<,Y72886764IND7304305F3307205<<<<<<<<<<<<<<56,30/04/1973,21/07/2023,BABU,20/07/2033,,,,SUNITHA,30/04/1973,KOCHI KERALA,COCHIN,20/07/2033,F,Y7288676,INDIA,IND,Y7288676,30/04/1973,20/07/2033,False,0,11.292699,4b26a621-49ee-4611-bdb3-556b18fee74c,bf6f76a3-5373-4d0d-8667-e21c6b6d7fdf,,,,,,,,,,,,,,,,,,,,,,,,,,,,84632,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,,JACINTA ITORIN,F,F,Y2387477,IND,FERNANDES,P<INDFERNANDES<<JACINTA<ITORIN<<<<<<<<<<<<<<<<<,Y2387477<8IND8004082F34051561066529435724<68,08/04/1980,16/05/2024,FERNANDES,15/05/2034,DIYOG SALU DSOUZA,,PERAPEDIN,JACINTA ITORIN,08/04/1980,VENGURLA MAHARASHTRA,PANAJI,15/05/2034,F,Y2387477,INDIA,IND,Y2387477,08/04/1980,15/05/2034,False,0,45.212148,c50f7283-eddc-4686-9bb8-9ab88af103f5,6242ffc6-2ed0-4343-9e64-ee5b9047190f,Y2387477,Y2387477,IND,IND,JACINTA ITORIN,FERNANDES,,F,F,VENGURLA MAHARASHTRA,08/04/1980,08/04/1980,16/05/2024,15/05/2034,15/05/2034,PERAPEDIN,DIYOG SALU DSOUZA,PANAJI,INDIA,P<INDFERNANDES<<JACINTA<ITORIN<<<<<<<<<<<<<<<<<,Y2387477<8IND8004082F34051561066529435724<68,Y2387477,08/04/1980,15/05/2034,F,FERNANDES,JACINTA ITORIN,85593,"{""output"": NaN, ""original number"": ""Y2387477"", ""number"": ""Y2387477"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""JACINTA ITORIN"", ""surname"": ""FERNANDES"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""VENGURLA MAHARASHTRA"", ""original birth date"": ""08/04/1980"", ""birth date"": ""08/04/1980"", ""issue date"": ""16/05/2024"", ""original expiry date"": ""15/05/2034"", ""expiry date"": ""15/05/2034"", ""mother name"": ""PERAPEDIN"", ""father name"": ""DIYOG SALU DSOUZA"", ""place of issue"": ""PANAJI"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDFERNANDES<<JACINTA<ITORIN<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""Y2387477<8IND8004082F34051561066529435724<68"", ""mrzPassportNumber"": ""Y2387477"", ""mrzDateOfBirth"": ""08/04/1980"", ""mrzDateOfExpiry"": ""15/05/2034"", ""mrzSex"": ""F"", ""mrzSurname"": ""FERNANDES"", ""mrzGivenNames"": ""JACINTA ITORIN""}"
,,SEEMA RANI,F,F,C0133685,IND,SEEMA RANI,P<IND<SEEMA<RANI<<<<<<<<<<<<<<<<<<<<<<<<<,C0133685<2IND9401264F34071492069744801424<90,26/01/1994,15/07/2024,SEEMA RANI,14/07/2034,RAJINDER SINGH,,RANJIT,SEEMA RANI,26/01/1994,BHUCCHO MANDI PUNJAB,CHANDIGARH,14/07/2034,F,C0133685,INDIA,IND,C0133685,26/01/1994,14/07/2034,False,0,21.72675,43969553-e7ad-4362-b067-80eaf7f74383,1e3f796e-cd54-446c-accb-13f98b834727,C0133685,C0133685,IND,IND,SEEMA RANI,SEEMA RANI,,F,F,BHUCHO MANDI PUNJAB,26/01/1994,26/01/1994,15/07/2024,14/07/2034,14/07/2034,RANJIT,RAJINDER SINGH,CHANDIGARH,INDIA,P<IND<SEEMA<RANI<<<<<<<<<<<<<<<<<<<<<<<<<,C0133685<2IND9401264F34071492069744801424<90,C0133685,26/01/1994,14/07/2034,F,SEEMA RANI,,85517,"{""output"": NaN, ""original number"": ""C0133685"", ""number"": ""C0133685"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""SEEMA RANI"", ""surname"": ""SEEMA RANI"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""BHUCHO MANDI PUNJAB"", ""original birth date"": ""26/01/1994"", ""birth date"": ""26/01/1994"", ""issue date"": ""15/07/2024"", ""original expiry date"": ""14/07/2034"", ""expiry date"": ""14/07/2034"", ""mother name"": ""RANJIT"", ""father name"": ""RAJINDER SINGH"", ""place of issue"": ""CHANDIGARH"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<IND<SEEMA<RANI<<<<<<<<<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""C0133685<2IND9401264F34071492069744801424<90"", ""mrzPassportNumber"": ""C0133685"", ""mrzDateOfBirth"": ""26/01/1994"", ""mrzDateOfExpiry"": ""14/07/2034"", ""mrzSex"": ""F"", ""mrzSurname"": ""SEEMA RANI"", ""mrzGivenNames"": """"}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",ANTOINETTE MELWYN OWEN,F,F,N1258162,IND,REBEIRO,P<INDREBEIRO<ANTOINETTE<MELWYN<OWEN<<<<<<<<<<,N1258162<4IND7001071F2507097<<<<<<<<<<<<<<04,01/01/1970,10/07/2015,REBEIRO,09/07/2025,MELVILLE ANTHONY REBEIRO,,LILLIE,ANTOINETTE MELWYN OWEN,07/01/1970,ARIPALAM KERALA,MUMBAI,09/07/2025,F,N1258162,INDIA,IND,N1258162,01/01/1970,09/07/2025,False,0,22.310688,c7c02704-7b78-44aa-a9eb-0484fd3d7e00,963a432f-a4f0-4378-9d07-90c1f4f3f196,,,,,,,,,,,,,,,,,,,,,,,,,,,,85237,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",PUSHPA,F,F,P9631640,IND,CHETTRI,P<INDCHETTRI<<PUSHPA<<<<<<<<<<<<<<<<<<<<<<,P96316406IND7603307F2702054<<<<<<<<<<<<<<,30/09/1976,06/02/2017,CHETTRI,05/02/2027,GIYAN BAHADUR CHETTRI,,VAGY,PUSHPA,30/09/1976,KALIMPONG,SINGAPORE,05/02/2027,F,P9631640,SINGAPORE,IND,P96316406,30/09/1976,05/02/2027,False,0,13.842982,441d8abe-4e04-453b-a4f1-a328878bf800,af1a8a44-22c1-4bab-9c78-2d9bbcac8475,,,,,,,,,,,,,,,,,,,,,,,,,,,,85503,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"RateLimitError(""Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4o in organization org-yqYoxY18hi8W4vEGmsvVjL9l on tokens per min (TPM): Limit 800000, Used 797615, Requested 46005. Please try again in 3.271s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}"")

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 201, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 186, in _invoke
    for attempt in self._sync_retrying(reraise=True):
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 420, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 187, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/concurrent/futures/_base.py"", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/concurrent/futures/_base.py"", line 401, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 188, in _invoke
    result = super().invoke(
             ^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 5416, in invoke
    return self.bound.invoke(
           ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 369, in invoke
    self.generate_prompt(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 946, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 765, in generate
    self._generate_with_cache(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 1011, in _generate_with_cache
    result = self._generate(
             ^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_openai/chat_models/base.py"", line 991, in _generate
    response = self.client.create(**payload)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_utils/_utils.py"", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/resources/chat/completions/completions.py"", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_base_client.py"", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_base_client.py"", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4o in organization org-yqYoxY18hi8W4vEGmsvVjL9l on tokens per min (TPM): Limit 800000, Used 797615, Requested 46005. Please try again in 3.271s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}
",TEJALBAHEN VIJAYKUMAR,F,F,C2597071,IND,PAREKH,P<INDPAREKH<TEJALBAHEN<VIJAYKUMAR<<<<<<<<<<<<<<,C2597071<IND7701041F3410021036369024<<<<<<<<<20,04/01/1977,03/10/2024,PAREKH,02/10/2034,KANTILAL KODARLAL PAREKH,,NAYNABEN,TEJALBAHEN VIJAYKUMAR,04/01/1977,KALOL PANCHMAHALS GUJARAT,AHMEDABAD,02/10/2034,F,C2597071,INDIA,IND,C2597071,04/01/1977,02/10/2034,False,0,43.862558,8fe15fec-51d1-469a-aab7-0d9ee15ba049,704d08a9-5ab5-475c-a355-ce293a6f0844,,,,,,,,,,,,,,,,,,,,,,,,,,,,83661,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException('Invalid json output: I\'m unable to process images directly. However, I can guide you on how to extract the necessary information from a passport image using OCR tools and the rules provided. Here\'s a general approach:\n\n1. **Pre-process the Image:**\n   - Rotate and deskew the image if necessary.\n   - Enhance contrast and remove noise.\n\n2. **Run OCR:**\n   - Use a high-accuracy OCR tool to extract text from the image.\n\n3. **Extract Fields:**\n   - **Number:** Extract from the MRZ and OCR, validate, and choose the correct one.\n   - **Country:** Use the ISO 3166-1 alpha-3 code from OCR or MRZ.\n   - **Name and Surname:** Extract from both OCR and MRZ, clean, and validate.\n   - **Middle Name:** Extract if available, otherwise set to """".\n   - **Gender:** Prefer MRZ if conflicting.\n   - **Place of Birth and Issue:** Clean and validate according to rules.\n   - **Dates (Birth, Issue, Expiry):** Extract, validate, and format as DD/MM/YYYY.\n   - **Parental Names:** Extract if available.\n\n4. **Validate and Reconcile:**\n   - Use MRZ data to validate and correct OCR data where necessary.\n   - Ensure logical consistency of dates.\n\n5. **Output JSON:**\n   - Structure the extracted data into the specified JSON format.\n\nIf you have specific questions about any step, feel free to ask!\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE ')

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from a passport image using OCR tools and the rules provided. Here's a general approach:

1. **Pre-process the Image:**
   - Rotate and deskew the image if necessary.
   - Enhance contrast and remove noise.

2. **Run OCR:**
   - Use a high-accuracy OCR tool to extract text from the image.

3. **Extract Fields:**
   - **Number:** Extract from the MRZ and OCR, validate, and choose the correct one.
   - **Country:** Use the ISO 3166-1 alpha-3 code from OCR or MRZ.
   - **Name and Surname:** Extract from both OCR and MRZ, clean, and validate.
   - **Middle Name:** Extract if available, otherwise set to """".
   - **Gender:** Prefer MRZ if conflicting.
   - **Place of Birth and Issue:** Clean and validate according to rules.
   - **Dates (Birth, Issue, Expiry):** Extract, validate, and format as DD/MM/YYYY.
   - **Parental Names:** Extract if available.

4. **Validate and Reconcile:**
   - Use MRZ data to validate and correct OCR data where necessary.
   - Ensure logical consistency of dates.

5. **Output JSON:**
   - Structure the extracted data into the specified JSON format.

If you have specific questions about any step, feel free to ask!
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",VALSAMMA,F,F,T8521745,IND,JOSEPH,P<INDJOSEPH<VALSAMMA<<<<<<<<<<<<<<<<<<<<<,T8521745<9IND6405283F2910024<<<<<<<<<<<<<<,28/05/1966,03/10/2019,JOSEPH,02/10/2029,SANKARAN,,LEELA,VALSAMMA,28/05/1966,KOTTIYOOR KERALA,KOZHIKODE,02/10/2029,F,T8521745,INDIA,IND,T8521745,28/05/1966,02/10/2029,False,0,73.330868,83add257-2bcc-42c1-9503-4107d560a590,ceaa235d-254c-4da4-a230-6662e7e7907f,,,,,,,,,,,,,,,,,,,,,,,,,,,,85614,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException('Invalid json output: I\'m unable to process images directly. However, I can guide you on how to extract the necessary information from the passport image using OCR software and the rules provided. Here\'s a step-by-step guide:\n\n1. **Pre-process the Image:**\n   - Rotate and deskew the image if necessary.\n   - Enhance contrast and remove noise.\n\n2. **Run OCR:**\n   - Use high-accuracy OCR software to extract text from the image.\n\n3. **Extract Fields:**\n   - **Number:** Extract from the MRZ and OCR. Validate and choose the correct one.\n   - **Country:** Use the ISO 3166-1 alpha-3 code from OCR or MRZ.\n   - **Name and Surname:** Extract from OCR and MRZ, clean up, and validate.\n   - **Middle Name:** Use OCR if available, otherwise set to """".\n   - **Gender:** Prefer MRZ if conflicting.\n   - **Place of Birth:** Clean up and validate using rules.\n   - **Birth Date:** Validate against MRZ and OCR.\n   - **Issue Date:** Extract only from the OCR ""Date of Issue"" field.\n   - **Expiry Date:** Validate against MRZ and OCR.\n   - **Place and Country of Issue:** Extract and normalize from OCR.\n\n4. **MRZ Extraction:**\n   - Extract `mrzLine1` and `mrzLine2`.\n   - Parse and validate MRZ fields.\n\n5. **Validation and Reconciliation:**\n   - Cross-validate fields between OCR and MRZ.\n   - Ensure logical date order: `birth date` <= `issue date` < `expiry date`.\n\n6. **Construct JSON:**\n   - Assemble the final JSON object with validated data.\n\nIf you have specific questions about any step, feel free to ask!\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE ')

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from the passport image using OCR software and the rules provided. Here's a step-by-step guide:

1. **Pre-process the Image:**
   - Rotate and deskew the image if necessary.
   - Enhance contrast and remove noise.

2. **Run OCR:**
   - Use high-accuracy OCR software to extract text from the image.

3. **Extract Fields:**
   - **Number:** Extract from the MRZ and OCR. Validate and choose the correct one.
   - **Country:** Use the ISO 3166-1 alpha-3 code from OCR or MRZ.
   - **Name and Surname:** Extract from OCR and MRZ, clean up, and validate.
   - **Middle Name:** Use OCR if available, otherwise set to """".
   - **Gender:** Prefer MRZ if conflicting.
   - **Place of Birth:** Clean up and validate using rules.
   - **Birth Date:** Validate against MRZ and OCR.
   - **Issue Date:** Extract only from the OCR ""Date of Issue"" field.
   - **Expiry Date:** Validate against MRZ and OCR.
   - **Place and Country of Issue:** Extract and normalize from OCR.

4. **MRZ Extraction:**
   - Extract `mrzLine1` and `mrzLine2`.
   - Parse and validate MRZ fields.

5. **Validation and Reconciliation:**
   - Cross-validate fields between OCR and MRZ.
   - Ensure logical date order: `birth date` <= `issue date` < `expiry date`.

6. **Construct JSON:**
   - Assemble the final JSON object with validated data.

If you have specific questions about any step, feel free to ask!
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",VALANKANI,F,F,S6822411,IND,FERNANDES,P<INDFERNANDES<<VALANKANI<<<<<<<<<<<<<<<<<,S68224116IND9411302F2902212<<<<<<<<<<<<<<04,30/11/1994,22/02/2019,FERNANDES,21/02/2029,MARCELIN FERNANDES,,MILAGRIMA,VALANKANI,30/11/1994,MAPUSA GOA,PANAJI,21/02/2029,F,S6822411,INDIA,IND,S6822411,30/11/1994,21/02/2029,False,0,20.734838,0d41b3ce-1fce-4413-85e0-7dd7621f1a3d,e6d75d1b-4b4a-48d1-a811-dff537808585,,,,,,,,,,,,,,,,,,,,,,,,,,,,85522,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"RateLimitError(""Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4o in organization org-yqYoxY18hi8W4vEGmsvVjL9l on tokens per min (TPM): Limit 800000, Used 796710, Requested 46005. Please try again in 3.203s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}"")

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 201, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 186, in _invoke
    for attempt in self._sync_retrying(reraise=True):
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 420, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 187, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/concurrent/futures/_base.py"", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/concurrent/futures/_base.py"", line 401, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 188, in _invoke
    result = super().invoke(
             ^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 5416, in invoke
    return self.bound.invoke(
           ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 369, in invoke
    self.generate_prompt(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 946, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 765, in generate
    self._generate_with_cache(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 1011, in _generate_with_cache
    result = self._generate(
             ^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_openai/chat_models/base.py"", line 991, in _generate
    response = self.client.create(**payload)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_utils/_utils.py"", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/resources/chat/completions/completions.py"", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_base_client.py"", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_base_client.py"", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4o in organization org-yqYoxY18hi8W4vEGmsvVjL9l on tokens per min (TPM): Limit 800000, Used 796710, Requested 46005. Please try again in 3.203s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}
",J JIJI,F,F,G4747313,IND,PLAVILAVADAKKATHIL THOMAS,P<INDPLAVILAVADAKKATHIL<THOMAS<<JIJI<<<<<<<<<<<<<<<<<<<<<,G4747313<1IND8005034F3412042106716120032436,03/05/1980,05/12/2024,PLAVILAVADAKKATHIL THOMAS,04/12/2034,THOMAS D,,MARY,JIJI,03/05/1980,ENATHU KERALA,TRIVANDRUM,04/12/2034,F,G4747313,INDIA,IND,G4747313,03/05/1980,04/12/2034,False,0,42.8917,68f0f8fe-7c71-4b52-ba0a-659ccca4f576,a9d8cdc8-df0c-45eb-b96b-ea3b0f495c82,,,,,,,,,,,,,,,,,,,,,,,,,,,,85027,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",SUNITHA,F,F,C5988252,IND,SUNITHA,P<IND<SUNITHA<<<<<<<<<<<<<<<<<<<<<<<<,C5988252<1IND7503201F34121232067204681324<50,20/03/1975,13/12/2024,SUNITHA,12/12/2034,PADMANABHAN,,,,20/03/1975,KOCHI KERALA,COCHIN,12/12/2034,F,C5988252,INDIA,IND,C5988252,20/03/1975,12/12/2034,False,0,33.48487,7c5fd19e-975a-47dd-b610-3096c9293c39,446b7b1f-4d80-40c3-90bf-c0f2f23ec369,,,,,,,,,,,,,,,,,,,,,,,,,,,,79059,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,,BISSY,F,F,V4195788,IND,ASHOKAN,P<INDASHOKAN<<BISSY<<<<<<<<<<<<<<<<<<<<<<,V4195788<5IND8208156F3111079<<<<<<<<<<<<<<06,15/08/1982,08/11/2021,ASHOKAN,07/11/2031,THAMBI,,CHINNAMMA,BISSY,15/08/1982,PUTHENVELIKKARA KERALA,COCHIN,07/11/2031,F,V4195788,INDIA,IND,V4195788,15/08/1982,07/11/2031,False,0,21.464101,ed9db088-4e10-4de7-b38c-0471067ba749,34f8cc64-5171-406d-93ea-babf32958122,V4195788,V4195788,IND,IND,BISSY,ASHOKAN,,F,F,PUTHENVELIKKARA KERALA,15/08/1982,15/08/1982,08/11/2021,07/11/2031,07/11/2031,CHINNAMMA,THAMBI,COCHIN,INDIA,P<INDASHOKAN<<BISSY<<<<<<<<<<<<<<<<<<<<<<<<<,V4195788<5IND8208156F31110795603666415721<60,V4195788,15/08/1982,07/11/2031,F,ASHOKAN,BISSY,87241,"{""output"": NaN, ""original number"": ""V4195788"", ""number"": ""V4195788"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""BISSY"", ""surname"": ""ASHOKAN"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""PUTHENVELIKKARA KERALA"", ""original birth date"": ""15/08/1982"", ""birth date"": ""15/08/1982"", ""issue date"": ""08/11/2021"", ""original expiry date"": ""07/11/2031"", ""expiry date"": ""07/11/2031"", ""mother name"": ""CHINNAMMA"", ""father name"": ""THAMBI"", ""place of issue"": ""COCHIN"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDASHOKAN<<BISSY<<<<<<<<<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""V4195788<5IND8208156F31110795603666415721<60"", ""mrzPassportNumber"": ""V4195788"", ""mrzDateOfBirth"": ""15/08/1982"", ""mrzDateOfExpiry"": ""07/11/2031"", ""mrzSex"": ""F"", ""mrzSurname"": ""ASHOKAN"", ""mrzGivenNames"": ""BISSY""}"
,,SAKHEENA,F,F,W0293596,IND,KANHIRAMKANDY,P<IND<SAKHEENA<KANHIRAMKANDY<<<<<<<<<<<<<<<<<,W02935964IND7205136F3209192007469283722<76,13/05/1972,20/09/2022,KANHIRAMKANDY,19/09/2032,MOIDU KANHIRAMKANDY,,NABEESA,SAKHEENA,13/05/1972,CHOMBALA KERALA,MUSCAT,19/09/2032,F,W0293596,OMAN,IND,W0293596,13/05/1972,19/09/2032,False,0,19.545536,9331673e-c7e7-4894-a10c-cc16e4823a77,a4f6e009-18a9-4f70-af96-74f4bb68e8c7,W0293596,W0293596,IND,IND,SAKHEENA KANHIRAMKANDY,KANHIRAMKANDY,,F,F,CHOMBALA KERALA,13/05/1972,13/05/1972,20/09/2022,19/09/2032,19/09/2032,NABEESA,MOIDU KANHIRAMKANDY,MUSCAT,OMAN,P<IND<SAKHEENA<KANHIRAMKANDY<<<<<<<<<<<<<<<<<,W02935964IND7205136F32091920074769283722<76,W0293596,13/05/1972,19/09/2032,F,KANHIRAMKANDY,SAKHEENA,85516,"{""output"": NaN, ""original number"": ""W0293596"", ""number"": ""W0293596"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""SAKHEENA KANHIRAMKANDY"", ""surname"": ""KANHIRAMKANDY"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""CHOMBALA KERALA"", ""original birth date"": ""13/05/1972"", ""birth date"": ""13/05/1972"", ""issue date"": ""20/09/2022"", ""original expiry date"": ""19/09/2032"", ""expiry date"": ""19/09/2032"", ""mother name"": ""NABEESA"", ""father name"": ""MOIDU KANHIRAMKANDY"", ""place of issue"": ""MUSCAT"", ""country of issue"": ""OMAN"", ""mrzLine1"": ""P<IND<SAKHEENA<KANHIRAMKANDY<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""W02935964IND7205136F32091920074769283722<76"", ""mrzPassportNumber"": ""W0293596"", ""mrzDateOfBirth"": ""13/05/1972"", ""mrzDateOfExpiry"": ""19/09/2032"", ""mrzSex"": ""F"", ""mrzSurname"": ""KANHIRAMKANDY"", ""mrzGivenNames"": ""SAKHEENA""}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",KUSUM,F,F,S8485255,IND,DEVI,P<INDDEVI<<KUSUM<<<<<<<<<<<<<<<<<<<<<<<<<,S8485255<IND7101010F2904032<<<<<<<<<<<<<<04,01/01/1971,04/04/2019,DEVI,03/04/2029,NAGENDRA SINGH,,DULIYA,KUSUM,01/01/1971,SEMAPUR BENJI BIHAR,PATNA,03/04/2029,F,S8485255,INDIA,IND,S8485255,01/01/1971,03/04/2029,False,0,15.22952,3a6c2a52-2ad0-4cf8-afe3-39f86df0a178,1b8786dd-0325-4388-838b-fdf8fffc7567,,,,,,,,,,,,,,,,,,,,,,,,,,,,87423,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from a passport image using OCR tools and the rules provided. Here's a general approach:\n\n1. **Pre-process the Image:**\n   - Rotate and deskew the image if necessary.\n   - Enhance contrast and remove noise.\n\n2. **Run OCR:**\n   - Use a high-accuracy OCR tool to extract text from the image.\n\n3. **Extract MRZ:**\n   - Locate and extract the two lines of the MRZ.\n\n4. **Field Extraction:**\n   - Extract fields like number, country, name, surname, etc., using the rules provided.\n\n5. **Validation and Normalization:**\n   - Validate and normalize each field according to the rules, such as checking the format of dates and passport numbers.\n\n6. **JSON Construction:**\n   - Construct a JSON object with the extracted and validated data.\n\nIf you have access to OCR software, you can apply these steps to extract the data. If you need further assistance with specific steps, feel free to ask!\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from a passport image using OCR tools and the rules provided. Here's a general approach:

1. **Pre-process the Image:**
   - Rotate and deskew the image if necessary.
   - Enhance contrast and remove noise.

2. **Run OCR:**
   - Use a high-accuracy OCR tool to extract text from the image.

3. **Extract MRZ:**
   - Locate and extract the two lines of the MRZ.

4. **Field Extraction:**
   - Extract fields like number, country, name, surname, etc., using the rules provided.

5. **Validation and Normalization:**
   - Validate and normalize each field according to the rules, such as checking the format of dates and passport numbers.

6. **JSON Construction:**
   - Construct a JSON object with the extracted and validated data.

If you have access to OCR software, you can apply these steps to extract the data. If you need further assistance with specific steps, feel free to ask!
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",SONA RANI,F,F,C3967176,IND,SONA RANI,P<IND<SONA<RANI<<<<<<<<<<<<<<<<<<<<<<<<<,C3967176<3IND0002163F34100820260191295424,16/02/2000,09/10/2024,SONA RANI,08/10/2034,KARNAIL SINGH,,SUKHPAL,,16/02/2000,SARDARWALA HARYANA,CHANDIGARH,08/10/2034,F,C3967176,INDIA,IND,C3967176,16/02/2000,08/10/2034,False,0,20.930716,85e67b08-a730-4338-9f2f-c85b2627714b,103e0b47-86d4-4223-8412-8009ef220b85,,,,,,,,,,,,,,,,,,,,,,,,,,,,83878,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"RateLimitError(""Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4o in organization org-yqYoxY18hi8W4vEGmsvVjL9l on tokens per min (TPM): Limit 800000, Used 796604, Requested 46005. Please try again in 3.195s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}"")

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 201, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 186, in _invoke
    for attempt in self._sync_retrying(reraise=True):
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 420, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 187, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/concurrent/futures/_base.py"", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/concurrent/futures/_base.py"", line 401, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 188, in _invoke
    result = super().invoke(
             ^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 5416, in invoke
    return self.bound.invoke(
           ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 369, in invoke
    self.generate_prompt(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 946, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 765, in generate
    self._generate_with_cache(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 1011, in _generate_with_cache
    result = self._generate(
             ^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_openai/chat_models/base.py"", line 991, in _generate
    response = self.client.create(**payload)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_utils/_utils.py"", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/resources/chat/completions/completions.py"", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_base_client.py"", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_base_client.py"", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4o in organization org-yqYoxY18hi8W4vEGmsvVjL9l on tokens per min (TPM): Limit 800000, Used 796604, Requested 46005. Please try again in 3.195s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}
",DIVYA,F,F,Y3059241,IND,JAYAN,P<INDJAYAN<<DIVYA<<<<<<<<<<<<<<<<<<<<<<<<<,Y3059241<2IND9708077F3405215<<<<<<<<<<<<<<04,07/08/1997,22/05/2020,JAYAN,21/05/2034,KRISHNAPPA,,SHANITA,DIVYA,07/08/1997,MULKI KARNATAKA,KOZHIKODE,21/05/2034,F,Y3059241,INDIA,IND,Y3059241,07/08/1997,21/05/2034,False,0,43.68999,0b02bd06-6c7a-439d-abe1-3a870f227dc3,52f2f98d-33a1-489a-9b69-c3b59e5c3ed3,,,,,,,,,,,,,,,,,,,,,,,,,,,,85572,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"RateLimitError(""Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4o in organization org-yqYoxY18hi8W4vEGmsvVjL9l on tokens per min (TPM): Limit 800000, Used 795039, Requested 46005. Please try again in 3.078s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}"")

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 201, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 186, in _invoke
    for attempt in self._sync_retrying(reraise=True):
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 420, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 187, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/concurrent/futures/_base.py"", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/concurrent/futures/_base.py"", line 401, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 188, in _invoke
    result = super().invoke(
             ^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 5416, in invoke
    return self.bound.invoke(
           ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 369, in invoke
    self.generate_prompt(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 946, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 765, in generate
    self._generate_with_cache(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 1011, in _generate_with_cache
    result = self._generate(
             ^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_openai/chat_models/base.py"", line 991, in _generate
    response = self.client.create(**payload)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_utils/_utils.py"", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/resources/chat/completions/completions.py"", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_base_client.py"", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_base_client.py"", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4o in organization org-yqYoxY18hi8W4vEGmsvVjL9l on tokens per min (TPM): Limit 800000, Used 795039, Requested 46005. Please try again in 3.078s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}
",VAISHALI SHIVAJI,F,F,W2175158,IND,JADHAV,P<INDJADHAV<<VAISHALI<SHIVAJI<<<<<<<<<<<<<<<<<,W2175158<5IND8006279F3207126<<<<<<<<<<<<<<06,27/06/1980,13/07/2022,JADHAV,12/07/2032,SHIVAJI JADHAV,,PARVATI,VAISHALI SHIVAJI,27/06/1980,RATNAGIRI MAHARASHTRA,MUMBAI,12/07/2032,F,W2175158,INDIA,IND,W2175158,27/06/1980,12/07/2032,False,0,43.813489,e2e09f6d-b4ef-4217-81d0-8b51a3c1ab9c,81a7793c-ebe8-4292-99ca-03dc62e62745,,,,,,,,,,,,,,,,,,,,,,,,,,,,85739,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,,MANJULA,F,F,C8139889,IND,THIYAGALINGAM,P<INDTHIYAGALINGAM<MANJULA<<<<<<<<<<<<<<<<<<<<<,C8139889<8IND6602222F3502112407732732552562,22/02/1966,12/02/2025,THIYAGALINGAM,11/02/2035,,,,MANJULA,22/02/1966,"TRICHY, TAMIL NADU",,11/02/2035,F,C8139889,,IND,C8139889,22/02/1966,11/02/2035,False,0,20.268169,25e0aac0-a456-4a3c-9d42-db094e1c42f6,d1cb54cb-4c56-47a6-a345-fb7a4566c2ad,C8139889,C8139889,IND,IND,MANJULA,THIYAGALINGAM,,F,F,TRICHY TAMIL NADU,22/02/1966,22/02/1966,12/02/2025,11/02/2035,11/02/2035,,,TIRUCHIRAPPALLI,INDIA,P<INDTHIYAGALINGAM<<MANJULA<<<<<<<<<<<<<<<<<<<<<,C8139889<IND6602222F3502112407732732552562,C8139889,22/02/1966,11/02/2035,F,THIYAGALINGAM,MANJULA,87349,"{""output"": NaN, ""original number"": ""C8139889"", ""number"": ""C8139889"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""MANJULA"", ""surname"": ""THIYAGALINGAM"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""TRICHY TAMIL NADU"", ""original birth date"": ""22/02/1966"", ""birth date"": ""22/02/1966"", ""issue date"": ""12/02/2025"", ""original expiry date"": ""11/02/2035"", ""expiry date"": ""11/02/2035"", ""mother name"": """", ""father name"": """", ""place of issue"": ""TIRUCHIRAPPALLI"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDTHIYAGALINGAM<<MANJULA<<<<<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""C8139889<IND6602222F3502112407732732552562"", ""mrzPassportNumber"": ""C8139889"", ""mrzDateOfBirth"": ""22/02/1966"", ""mrzDateOfExpiry"": ""11/02/2035"", ""mrzSex"": ""F"", ""mrzSurname"": ""THIYAGALINGAM"", ""mrzGivenNames"": ""MANJULA""}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",KHUSHPREET,F,F,S2488955,IND,KHUSHPREET,P<INDKHUSHPREET<<<<<<<<<<<<<<<<<<<<<<,S2488955<5IND9705250F2806011<<<<<<<<4,25/05/1997,02/06/2018,KHUSHPREET,01/06/2028,HARVINDER SINGH,,RATANJIT,,25/05/1997,KALANAUR PUNJAB,JALANDHAR,01/06/2028,F,S2488955,INDIA,IND,S2488955,25/05/1997,01/06/2028,False,0,44.231184,3c5bcba9-f9a1-4d05-baa9-01c377ef033f,ecd80acf-30cb-4d2f-a24e-b516cf4193e9,,,,,,,,,,,,,,,,,,,,,,,,,,,,85490,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException('Invalid json output: I\'m unable to process images directly. However, I can guide you on how to extract the necessary information from the passport image using OCR tools and the rules provided. Here\'s a step-by-step approach:\n\n1. **Pre-process the Image:**\n   - Rotate and deskew the image if necessary.\n   - Enhance contrast and remove noise.\n\n2. **Run OCR:**\n   - Use a high-accuracy OCR tool to extract text from the image.\n\n3. **Extract Fields:**\n   - **Number:** Extract from the MRZ (first 9 characters of the second line) and validate.\n   - **Country:** Use the ISO 3166-1 alpha-3 code from the MRZ or OCR.\n   - **Name and Surname:** Extract from the MRZ and OCR, clean and compare.\n   - **Middle Name:** Always empty for Indian passports.\n   - **Gender:** Prefer MRZ if conflicting.\n   - **Place of Birth:** Extract and clean according to rules.\n   - **Birth Date:** Validate against MRZ and OCR.\n   - **Issue Date:** Extract only from the OCR ""Date of Issue"" field.\n   - **Expiry Date:** Validate against MRZ and OCR.\n   - **Place and Country of Issue:** Extract and clean according to rules.\n   - **Parental Names:** Extract from the second page.\n\n4. **Validate and Reconcile:**\n   - Use MRZ data to validate and correct OCR data where necessary.\n   - Ensure dates are in DD/MM/YYYY format and logically consistent.\n\n5. **Output JSON:**\n   - Structure the extracted data into the specified JSON format.\n\nIf you have access to OCR software, you can apply these steps to extract and validate the data from the passport image.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE ')

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from the passport image using OCR tools and the rules provided. Here's a step-by-step approach:

1. **Pre-process the Image:**
   - Rotate and deskew the image if necessary.
   - Enhance contrast and remove noise.

2. **Run OCR:**
   - Use a high-accuracy OCR tool to extract text from the image.

3. **Extract Fields:**
   - **Number:** Extract from the MRZ (first 9 characters of the second line) and validate.
   - **Country:** Use the ISO 3166-1 alpha-3 code from the MRZ or OCR.
   - **Name and Surname:** Extract from the MRZ and OCR, clean and compare.
   - **Middle Name:** Always empty for Indian passports.
   - **Gender:** Prefer MRZ if conflicting.
   - **Place of Birth:** Extract and clean according to rules.
   - **Birth Date:** Validate against MRZ and OCR.
   - **Issue Date:** Extract only from the OCR ""Date of Issue"" field.
   - **Expiry Date:** Validate against MRZ and OCR.
   - **Place and Country of Issue:** Extract and clean according to rules.
   - **Parental Names:** Extract from the second page.

4. **Validate and Reconcile:**
   - Use MRZ data to validate and correct OCR data where necessary.
   - Ensure dates are in DD/MM/YYYY format and logically consistent.

5. **Output JSON:**
   - Structure the extracted data into the specified JSON format.

If you have access to OCR software, you can apply these steps to extract and validate the data from the passport image.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",RAJNI RANI,F,F,W6753346,IND,RAJNI,P<INDRAJNI<RANI<<<<<<<<<<<<<<<<<<<<<<<<<,W6753346<IND9704183F3211016<<<<<<<<<<<<<<08,18/04/1997,02/11/2022,RAJNI,01/11/2032,NARINDER SINGH,,BALWINDER,RANI,18/04/1997,KHALARA PUNJAB,JALANDHAR,01/11/2032,F,W6753346,INDIA,IND,W6753346,18/04/1997,01/11/2032,False,0,19.882602,f4a04e99-e9ca-4025-8a2d-c8a4b55e495c,b14d2f31-2eb1-4460-97a7-85631045fc4b,,,,,,,,,,,,,,,,,,,,,,,,,,,,85508,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",NIMISHA MUKESHKUMAR,F,F,V1244219,IND,PATEL,P<INDPATEL<<NIMISHA<MUKESHKUMAR<<<<<<<<<<<<<<,V1244219<8IND8411246F31081703065472113821<32,24/11/1984,18/08/2021,PATEL,17/08/2031,PRADYUMAN VISHAMBHAR SHUKLA,,KIRANBEN,NIMISHA MUKESHKUMAR,24/11/1984,AHMEDABAD GUJARAT,AHMEDABAD,17/08/2031,F,V1244219,INDIA,IND,V1244219,24/11/1984,17/08/2031,False,0,1.66818,0abdfe8f-2051-44b6-a3e5-e95e88599d92,2e3ecc0a-323a-4245-869e-d1e6e60c4632,,,,,,,,,,,,,,,,,,,,,,,,,,,,82614,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm sorry, I can't assist with that.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm sorry, I can't assist with that.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",POONAM RAVINDRA,F,F,T6391869,IND,NAGDA,P<INDNAGDA<<POONAM<RAVINDRA<<<<<<<<<<<<<<,T6391869<7IND7710193F2907022<<<<<<<<<<<<<<04,19/10/1977,03/07/2019,NAGDA,02/07/2029,JAGRAMBHAI HISHARAM YADAV,,SUREKHABEN,POONAM RAVINDRA,19/10/1977,RAJKOT GUJARAT,AHMEDABAD,02/07/2029,F,T6391869,INDIA,IND,T6391869,19/10/1977,02/07/2029,False,0,7.478897,16296fd5-ad49-4faf-bb99-b2a0f8d69309,9f77b978-3a95-43e9-9950-2cdc98304d4d,,,,,,,,,,,,,,,,,,,,,,,,,,,,86357,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,,ASHA,F,F,T6865206,IND,SARMA,P<INDSARMA<<ASHA<<<<<<<<<<<<<<<<<<<<<<<<<,T6865206<4IND7801011F2911249<<<<<<<<<<<<<<04,01/01/1978,25/11/2019,SARMA,24/11/2029,LALIT SHARMA,,DOLMO,ASHA,01/01/1978,BHATPARA B TE WEST BENGAL,KOLKATA,24/11/2029,F,T6865206,INDIA,IND,T6865206,01/01/1978,24/11/2029,False,0,22.879207,aa73c9a7-9bf7-4c83-a925-1c16ca223c21,7b9facde-d16e-4e53-87cd-fa14065fb0b3,T6865206,T6865206,IND,IND,ASHA,SARMA,,F,F,BHATPARA B TE WEST BENGAL,01/01/1978,01/01/1978,25/11/2019,24/11/2029,24/11/2029,DOLMO,LALIT SHARMA,KOLKATA,INDIA,P<INDSARMA<<ASHA<<<<<<<<<<<<<<<<<<<<<<<<<,T6865206<4IND7801011F2911249<<<<<<<<<<<<<<04,T6865206,01/01/1978,24/11/2029,F,SARMA,ASHA,87053,"{""output"": NaN, ""original number"": ""T6865206"", ""number"": ""T6865206"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""ASHA"", ""surname"": ""SARMA"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""BHATPARA B TE WEST BENGAL"", ""original birth date"": ""01/01/1978"", ""birth date"": ""01/01/1978"", ""issue date"": ""25/11/2019"", ""original expiry date"": ""24/11/2029"", ""expiry date"": ""24/11/2029"", ""mother name"": ""DOLMO"", ""father name"": ""LALIT SHARMA"", ""place of issue"": ""KOLKATA"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDSARMA<<ASHA<<<<<<<<<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""T6865206<4IND7801011F2911249<<<<<<<<<<<<<<04"", ""mrzPassportNumber"": ""T6865206"", ""mrzDateOfBirth"": ""01/01/1978"", ""mrzDateOfExpiry"": ""24/11/2029"", ""mrzSex"": ""F"", ""mrzSurname"": ""SARMA"", ""mrzGivenNames"": ""ASHA""}"
,"RateLimitError(""Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4o in organization org-yqYoxY18hi8W4vEGmsvVjL9l on tokens per min (TPM): Limit 800000, Used 798210, Requested 46005. Please try again in 3.316s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}"")

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 201, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 186, in _invoke
    for attempt in self._sync_retrying(reraise=True):
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 420, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 187, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/concurrent/futures/_base.py"", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/concurrent/futures/_base.py"", line 401, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 188, in _invoke
    result = super().invoke(
             ^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 5416, in invoke
    return self.bound.invoke(
           ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 369, in invoke
    self.generate_prompt(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 946, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 765, in generate
    self._generate_with_cache(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 1011, in _generate_with_cache
    result = self._generate(
             ^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_openai/chat_models/base.py"", line 991, in _generate
    response = self.client.create(**payload)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_utils/_utils.py"", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/resources/chat/completions/completions.py"", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_base_client.py"", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_base_client.py"", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4o in organization org-yqYoxY18hi8W4vEGmsvVjL9l on tokens per min (TPM): Limit 800000, Used 798210, Requested 46005. Please try again in 3.316s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}
",IMRAN KHAN,M,M,V2160544,IND,KHAN,P<IND<KHAN<<IMRAN<<<<<<<<<<<<<<<<<<<<<<,V2160544<1IND8904023M31120762074579025921<72,02/04/1989,08/12/2021,KHAN,07/12/2031,NIYAJ MOHAMED,,NIYAMAT,IMRAN,02/04/1989,ROLSABSAR RAJASTHAN,DUBAI,07/12/2031,M,V2160544,UAE,IND,V2160544,02/04/1989,07/12/2031,False,0,40.801737,6f5dce1f-a07a-4409-a1b0-6c0eb38429a9,72197e03-3616-4f60-b236-d940d9e3dde8,,,,,,,,,,,,,,,,,,,,,,,,,,,,84828,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,,GURMIT KAUR,F,F,V7383404,IND,KAUR,P<IND<GURMIT<KAUR<<<<<<<<<<<<<<<<<<<<<<<<<,V7383404<IND8101017F3203019<<<<<<<<<<<<<<,01/01/1981,02/03/2022,KAUR,01/03/2032,CHHINDER SINGH,,BALWINDER,GURMIT,01/01/1981,MARA KISHAN PURA PUNJAB,CHANDIGARH,01/03/2032,F,V7383404,INDIA,IND,V7383404,01/01/1981,01/03/2032,False,0,49.43432,3fbbbdd8-ebfc-4e57-836d-c2d9827b1a48,95252a32-5c43-44bf-8ccd-d82e65d1b5c3,V7383404,V7383404,IND,IND,GURMIT KAUR,GURMIT KAUR,,F,F,MARA KISHAN PURA PUNJAB,01/01/1981,01/01/1981,02/03/2022,01/03/2032,01/03/2032,BALWINDER,CHHINDER SINGH,CHANDIGARH,INDIA,P<IND<GURMIT<KAUR<<<<<<<<<<<<<<<<<<<<<<<<<,V7383404<IND8101017F3203019<<<<<<<<<<<<<<,V7383404,01/01/1981,01/03/2032,F,GURMIT KAUR,GURMIT KAUR,85454,"{""output"": NaN, ""original number"": ""V7383404"", ""number"": ""V7383404"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""GURMIT KAUR"", ""surname"": ""GURMIT KAUR"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""MARA KISHAN PURA PUNJAB"", ""original birth date"": ""01/01/1981"", ""birth date"": ""01/01/1981"", ""issue date"": ""02/03/2022"", ""original expiry date"": ""01/03/2032"", ""expiry date"": ""01/03/2032"", ""mother name"": ""BALWINDER"", ""father name"": ""CHHINDER SINGH"", ""place of issue"": ""CHANDIGARH"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<IND<GURMIT<KAUR<<<<<<<<<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""V7383404<IND8101017F3203019<<<<<<<<<<<<<<"", ""mrzPassportNumber"": ""V7383404"", ""mrzDateOfBirth"": ""01/01/1981"", ""mrzDateOfExpiry"": ""01/03/2032"", ""mrzSex"": ""F"", ""mrzSurname"": ""GURMIT KAUR"", ""mrzGivenNames"": ""GURMIT KAUR""}"
,"RateLimitError(""Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4o in organization org-yqYoxY18hi8W4vEGmsvVjL9l on tokens per min (TPM): Limit 800000, Used 796343, Requested 46005. Please try again in 3.176s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}"")

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 201, in invoke
    return self._call_with_config(self._invoke, input, config, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 186, in _invoke
    for attempt in self._sync_retrying(reraise=True):
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 445, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 420, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/tenacity/__init__.py"", line 187, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/concurrent/futures/_base.py"", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/concurrent/futures/_base.py"", line 401, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/retry.py"", line 188, in _invoke
    result = super().invoke(
             ^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 5416, in invoke
    return self.bound.invoke(
           ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 369, in invoke
    self.generate_prompt(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 946, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 765, in generate
    self._generate_with_cache(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/language_models/chat_models.py"", line 1011, in _generate_with_cache
    result = self._generate(
             ^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_openai/chat_models/base.py"", line 991, in _generate
    response = self.client.create(**payload)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_utils/_utils.py"", line 287, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/resources/chat/completions/completions.py"", line 925, in create
    return self._post(
           ^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_base_client.py"", line 1239, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/openai/_base_client.py"", line 1034, in request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4o in organization org-yqYoxY18hi8W4vEGmsvVjL9l on tokens per min (TPM): Limit 800000, Used 796343, Requested 46005. Please try again in 3.176s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}
",GOWRI,F,F,P3299586,IND,DASARI,P<INDDASARI<<GOWRI<<<<<<<<<<<<<<<<<<<<<<<<<,P32995856IND8306155F2606233<<<<<<<<<<<<<<,15/06/1983,24/06/2016,DASARI,23/06/2026,VENKATA RAO DASARI,,YESUDOSS,GOWRI,15/06/1983,BITRAGUNTA ANDHRA PRADESH,HYDERABAD,23/06/2026,F,P3299586,INDIA,IND,P3299585,15/06/1983,23/06/2026,False,0,45.751845,441809e3-5921-43e6-9c1f-cc84301a4c58,f28869dc-cfb8-44ee-bec4-88dbce5ede22,,,,,,,,,,,,,,,,,,,,,,,,,,,,85453,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,"OutputParserException(""Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from a passport image using OCR tools and the rules provided. Here's a step-by-step approach:\n\n1. **Pre-process the Image:**\n   - Rotate and deskew the image if necessary.\n   - Enhance contrast and remove noise.\n\n2. **Run OCR:**\n   - Use a high-accuracy OCR tool to extract text from the image.\n\n3. **Extract MRZ:**\n   - Locate the two-line MRZ at the bottom of the passport page.\n\n4. **Extract Fields:**\n   - **Number:** Extract from MRZ and OCR, validate, and choose the correct one.\n   - **Country:** Use ISO 3166-1 alpha-3 code from MRZ or OCR.\n   - **Name and Surname:** Extract from OCR and MRZ, clean, and validate.\n   - **Gender:** Prefer MRZ if conflicting.\n   - **Birth Date:** Validate against MRZ and OCR.\n   - **Issue and Expiry Dates:** Extract from OCR, validate against MRZ.\n   - **Place of Birth and Issue:** Clean and validate using rules.\n\n5. **Validate and Normalize:**\n   - Ensure all fields meet the specified format and rules.\n   - Use MRZ data to correct OCR errors where applicable.\n\n6. **Construct JSON:**\n   - Assemble the extracted and validated data into the specified JSON format.\n\nIf you have access to OCR software, you can apply these steps to extract and validate the data from the passport image.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from a passport image using OCR tools and the rules provided. Here's a step-by-step approach:

1. **Pre-process the Image:**
   - Rotate and deskew the image if necessary.
   - Enhance contrast and remove noise.

2. **Run OCR:**
   - Use a high-accuracy OCR tool to extract text from the image.

3. **Extract MRZ:**
   - Locate the two-line MRZ at the bottom of the passport page.

4. **Extract Fields:**
   - **Number:** Extract from MRZ and OCR, validate, and choose the correct one.
   - **Country:** Use ISO 3166-1 alpha-3 code from MRZ or OCR.
   - **Name and Surname:** Extract from OCR and MRZ, clean, and validate.
   - **Gender:** Prefer MRZ if conflicting.
   - **Birth Date:** Validate against MRZ and OCR.
   - **Issue and Expiry Dates:** Extract from OCR, validate against MRZ.
   - **Place of Birth and Issue:** Clean and validate using rules.

5. **Validate and Normalize:**
   - Ensure all fields meet the specified format and rules.
   - Use MRZ data to correct OCR errors where applicable.

6. **Construct JSON:**
   - Assemble the extracted and validated data into the specified JSON format.

If you have access to OCR software, you can apply these steps to extract and validate the data from the passport image.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",SUNIL KUMAR,M,M,U0766977,IND,PUTHIYANAM VEETTIL,P<INDPUTHIYANAM<VEETTIL<<SUNIL<KUMAR<<<<<<<<<<<<<,U0766977<6IND7701100M3002196<<<<<<<<<<<<<<06,10/01/1977,19/02/2020,PUTHIYANAM VEETTIL,19/02/2030,NARAYANAN THEYYATHUM VALAPPIL,,JANAKI,SUNIL KUMAR,10/01/1977,VELLORA KERALA,MUSCAT,19/02/2030,M,U0766977,OMAN,IND,U0766977,10/01/1977,19/02/2030,False,0,33.376,338ddfb8-4747-46b8-9b49-514fdaacfe35,eb510988-5329-4db5-9864-834f22ad8d8a,,,,,,,,,,,,,,,,,,,,,,,,,,,,85786,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,,VANDHANA KAUR,F,F,W5918000,IND,KAUR,P<IND<VANDHANA<KAUR<<<<<<<<<<<<<<<<<,W5918000<9IND0303125F3209183068569416226,12/03/2003,19/09/2022,KAUR,18/09/2032,DIDAR SINGH,,RAJWINDER,VANDHANA,12/03/2003,FATEHGARH PANJGRIAN PUNJAB,CHANDIGARH,18/09/2032,F,W5918000,INDIA,IND,W5918000,12/03/2003,18/09/2032,False,0,46.662741,0da4da30-f9d6-4351-947a-cc56df2d4439,41134ec0-ff75-4956-94c8-32c84c284737,W5918000,W5918000,IND,IND,VANDHANA KAUR,VANDHANA KAUR,,F,F,FATEHGARH PANJGRIAN PUNJAB,12/03/2003,12/03/2003,19/09/2022,18/09/2032,18/09/2032,RAJWINDER,DIDAR SINGH,CHANDIGARH,INDIA,P<INDVANDHANA<KAUR<<<<<<<<<<<<<<<<<,W5918000<9IND0303125F3209183<<<<<<<<<<26,W5918000,12/03/2003,18/09/2032,F,VANDHANA KAUR,,87969,"{""output"": NaN, ""original number"": ""W5918000"", ""number"": ""W5918000"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""VANDHANA KAUR"", ""surname"": ""VANDHANA KAUR"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""FATEHGARH PANJGRIAN PUNJAB"", ""original birth date"": ""12/03/2003"", ""birth date"": ""12/03/2003"", ""issue date"": ""19/09/2022"", ""original expiry date"": ""18/09/2032"", ""expiry date"": ""18/09/2032"", ""mother name"": ""RAJWINDER"", ""father name"": ""DIDAR SINGH"", ""place of issue"": ""CHANDIGARH"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDVANDHANA<KAUR<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""W5918000<9IND0303125F3209183<<<<<<<<<<26"", ""mrzPassportNumber"": ""W5918000"", ""mrzDateOfBirth"": ""12/03/2003"", ""mrzDateOfExpiry"": ""18/09/2032"", ""mrzSex"": ""F"", ""mrzSurname"": ""VANDHANA KAUR"", ""mrzGivenNames"": """"}"
,,NGURTHANGMAWII,F,F,W7305665,IND,NGURTHANGMAWII,INDNGURTHANGMAWII<<<<<<<<<<<<<<<<<,W730566514IND9011230F33051036782866243<14,23/11/1990,11/05/2023,NGURTHANGMAWII,10/05/2033,ZORAMA,,SAIRENGI,,23/11/1990,KEITUM MIZORAM,GUWAHATI,10/05/2033,F,W7305665,INDIA,IND,W7305665,23/11/1990,10/05/2033,False,0,31.404436,a71e28f0-9026-4002-97ca-dacb8e4f17c5,ff4da90e-107b-493a-9787-f6e8ee9175f4,W7305665,W7305665,IND,IND,NGURTHANGMAWII,,,F,F,KEITUM MIZORAM,23/11/1990,23/11/1990,11/05/2023,10/05/2033,10/05/2033,SAIRENGI,ZORAMA,GUWAHATI,INDIA,P<INDNGURTHANGMAWII<<<<<<<<<<<<<<<<<<<<<,W7305665012IND9011230F330510386782866243<14,W7305665,23/11/1990,10/05/2033,F,NGURTHANGMAWII,,85581,"{""output"": NaN, ""original number"": ""W7305665"", ""number"": ""W7305665"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""NGURTHANGMAWII"", ""surname"": """", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""KEITUM MIZORAM"", ""original birth date"": ""23/11/1990"", ""birth date"": ""23/11/1990"", ""issue date"": ""11/05/2023"", ""original expiry date"": ""10/05/2033"", ""expiry date"": ""10/05/2033"", ""mother name"": ""SAIRENGI"", ""father name"": ""ZORAMA"", ""place of issue"": ""GUWAHATI"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDNGURTHANGMAWII<<<<<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""W7305665012IND9011230F330510386782866243<14"", ""mrzPassportNumber"": ""W7305665"", ""mrzDateOfBirth"": ""23/11/1990"", ""mrzDateOfExpiry"": ""10/05/2033"", ""mrzSex"": ""F"", ""mrzSurname"": ""NGURTHANGMAWII"", ""mrzGivenNames"": """"}"
,,JAHNAVI,F,F,B6883081,IND,MADDINENI,P<INDMADDINENI<<JAHNAVI<<<<<<<<<<<<<<<<<<<<<,B6883081<7IND0302081F33101601065849722123<20,08/02/2001,17/10/2023,MADDINENI,16/10/2033,SUBRAMANYAM MADDINENI,,VARALAKSHMI,JAHNAVI,08/02/2001,CHAVANAVARIPALLI ANDHRA PRADESH,VIJAYAWADA,16/10/2033,F,B6883081,INDIA,IND,B6883081,08/02/2001,16/10/2033,False,0,30.753323,26a86fc3-1fab-4fff-80b8-1cf70e41b6bd,e7f8dc48-00bd-4454-bd9b-84d41b018e96,B6883081,B6883081,IND,IND,JAHNAVI,MADDINENI,,F,F,CHAVANAVARI PALLI ANDHRA PRADESH,08/02/2001,08/02/2001,17/10/2023,16/10/2033,16/10/2033,VARALAKSHMI,SUBRAMANYAM MADDINENI,VIJAYAWADA,INDIA,P<INDMADDINENI<<JAHNAVI<<<<<<<<<<<<<<<<<,B6883081<7IND0302081F33101601065849722123<20,B6883081,08/02/2001,16/10/2033,F,MADDINENI,JAHNAVI,85592,"{""output"": NaN, ""original number"": ""B6883081"", ""number"": ""B6883081"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""JAHNAVI"", ""surname"": ""MADDINENI"", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""CHAVANAVARI PALLI ANDHRA PRADESH"", ""original birth date"": ""08/02/2001"", ""birth date"": ""08/02/2001"", ""issue date"": ""17/10/2023"", ""original expiry date"": ""16/10/2033"", ""expiry date"": ""16/10/2033"", ""mother name"": ""VARALAKSHMI"", ""father name"": ""SUBRAMANYAM MADDINENI"", ""place of issue"": ""VIJAYAWADA"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<INDMADDINENI<<JAHNAVI<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""B6883081<7IND0302081F33101601065849722123<20"", ""mrzPassportNumber"": ""B6883081"", ""mrzDateOfBirth"": ""08/02/2001"", ""mrzDateOfExpiry"": ""16/10/2033"", ""mrzSex"": ""F"", ""mrzSurname"": ""MADDINENI"", ""mrzGivenNames"": ""JAHNAVI""}"
,"OutputParserException(""Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from a passport image using OCR tools and the rules provided. Here's a general approach:\n\n1. **Pre-process the Image:**\n   - Rotate and deskew the image if necessary.\n   - Enhance contrast and remove noise.\n\n2. **Run OCR:**\n   - Use a high-accuracy OCR tool to extract text from the image.\n\n3. **Extract MRZ:**\n   - Locate the two-line MRZ and extract the text.\n\n4. **Field Extraction:**\n   - Extract fields like passport number, name, surname, etc., using the rules provided.\n   - Normalize and clean the extracted data (e.g., remove diacritics, replace special characters).\n\n5. **Validation:**\n   - Validate fields against the rules (e.g., format checks, length checks).\n\n6. **JSON Output:**\n   - Structure the extracted and validated data into the specified JSON format.\n\nIf you have access to OCR software, you can apply these steps to extract and format the data as required.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE "")

Traceback (most recent call last):
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 86, in parse_result
    return parse_json_markdown(text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 150, in parse_json_markdown
    return _parse_json(json_str, parser=parser)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 166, in _parse_json
    return parser(json_str)
           ^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/utils/json.py"", line 123, in parse_partial_json
    return json.loads(s, strict=strict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/__init__.py"", line 359, in loads
    return cls(**kw).decode(s)
           ^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3.11/json/decoder.py"", line 355, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""<ipython-input-6-a3d51cbf6537>"", line 75, in target
    result = llm_chain_factory().invoke(formatted_inputs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 3034, in invoke
    input = context.run(step.invoke, input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 196, in invoke
    return self._call_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/base.py"", line 1930, in _call_with_config
    context.run(
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/runnables/config.py"", line 428, in call_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/base.py"", line 197, in <lambda>
    lambda inner_input: self.parse_result(
                        ^^^^^^^^^^^^^^^^^^
  File ""/usr/local/lib/python3.11/dist-packages/langchain_core/output_parsers/json.py"", line 89, in parse_result
    raise OutputParserException(msg, llm_output=text) from e
langchain_core.exceptions.OutputParserException: Invalid json output: I'm unable to process images directly. However, I can guide you on how to extract the necessary information from a passport image using OCR tools and the rules provided. Here's a general approach:

1. **Pre-process the Image:**
   - Rotate and deskew the image if necessary.
   - Enhance contrast and remove noise.

2. **Run OCR:**
   - Use a high-accuracy OCR tool to extract text from the image.

3. **Extract MRZ:**
   - Locate the two-line MRZ and extract the text.

4. **Field Extraction:**
   - Extract fields like passport number, name, surname, etc., using the rules provided.
   - Normalize and clean the extracted data (e.g., remove diacritics, replace special characters).

5. **Validation:**
   - Validate fields against the rules (e.g., format checks, length checks).

6. **JSON Output:**
   - Structure the extracted and validated data into the specified JSON format.

If you have access to OCR software, you can apply these steps to extract and format the data as required.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/OUTPUT_PARSING_FAILURE 
",ASMABIBI,F,F,W3739701,IND,SHAIKH,P<INDSHAIKH<<ASMABIBI<<<<<<<<<<<<<<<<<<<<<<,W3739701<8IND8607159F3208074<<<<<<<<<<<<<<08,15/07/1986,08/08/2022,SHAIKH,07/08/2032,YUSUF,,AAYSHA,ASMABIBI,15/07/1986,KATHOR SURAT GUJARAT,INDIA,07/08/2032,F,W3739701,INDIA,IND,W3739701,15/07/1986,07/08/2032,False,0,48.662783,ae88fcb2-2d73-40c1-a469-26a56f6398eb,c797d0de-405b-4bad-a5d1-2242654a6768,,,,,,,,,,,,,,,,,,,,,,,,,,,,87362,"{""output"": NaN, ""original number"": NaN, ""number"": NaN, ""original country"": NaN, ""country"": NaN, ""name"": NaN, ""surname"": NaN, ""middle name"": NaN, ""original gender"": NaN, ""gender"": NaN, ""place of birth"": NaN, ""original birth date"": NaN, ""birth date"": NaN, ""issue date"": NaN, ""original expiry date"": NaN, ""expiry date"": NaN, ""mother name"": NaN, ""father name"": NaN, ""place of issue"": NaN, ""country of issue"": NaN, ""mrzLine1"": NaN, ""mrzLine2"": NaN, ""mrzPassportNumber"": NaN, ""mrzDateOfBirth"": NaN, ""mrzDateOfExpiry"": NaN, ""mrzSex"": NaN, ""mrzSurname"": NaN, ""mrzGivenNames"": NaN}"
,,VENUS MARY,F,F,P3875886,IND,,P<IND<VENUS<MARY<<<<<<<<<<<<<<<<<<<<<<<<<,P3875886<8IND7402201F2608019<<<<<<<<<<<<<<04,20/02/1974,02/08/2016,,01/08/2026,ANTHONY GEORGE MOSES,,RANI,VENUS MARY,20/02/1974,BENGALURU KARNATAKA,BENGALURU,01/08/2026,F,P3875886,INDIA,IND,P3875886,20/02/1974,01/08/2026,False,0,55.696705,e8b5fdcb-958c-4f6d-ad66-c047abf3f88a,abe0022d-1fa2-4130-b389-d317b9969d7e,P3875886,P3875886,IND,IND,VENUS MARY,,,F,F,BENGALURU KARNATAKA,20/02/1974,20/02/1974,02/08/2016,01/08/2026,01/08/2026,RANI,ANTHONY GEORGE MOSES,BENGALURU,INDIA,P<IND<VENUS<MARY<<<<<<<<<<<<<<<<<<<<<<<<<,P3875886<8IND7402201F2608019<<<<<<<<<<<<<<04,P3875886,20/02/1974,01/08/2026,F,,VENUS MARY,85681,"{""output"": NaN, ""original number"": ""P3875886"", ""number"": ""P3875886"", ""original country"": ""IND"", ""country"": ""IND"", ""name"": ""VENUS MARY"", ""surname"": """", ""middle name"": """", ""original gender"": ""F"", ""gender"": ""F"", ""place of birth"": ""BENGALURU KARNATAKA"", ""original birth date"": ""20/02/1974"", ""birth date"": ""20/02/1974"", ""issue date"": ""02/08/2016"", ""original expiry date"": ""01/08/2026"", ""expiry date"": ""01/08/2026"", ""mother name"": ""RANI"", ""father name"": ""ANTHONY GEORGE MOSES"", ""place of issue"": ""BENGALURU"", ""country of issue"": ""INDIA"", ""mrzLine1"": ""P<IND<VENUS<MARY<<<<<<<<<<<<<<<<<<<<<<<<<"", ""mrzLine2"": ""P3875886<8IND7402201F2608019<<<<<<<<<<<<<<04"", ""mrzPassportNumber"": ""P3875886"", ""mrzDateOfBirth"": ""20/02/1974"", ""mrzDateOfExpiry"": ""01/08/2026"", ""mrzSex"": ""F"", ""mrzSurname"": """", ""mrzGivenNames"": ""VENUS MARY""}"
